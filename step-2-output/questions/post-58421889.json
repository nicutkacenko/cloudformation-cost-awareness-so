{"Id": "58421889", "PostTypeId": "1", "CreationDate": "2019-10-16T21:23:14.853", "Score": "2", "ViewCount": "862", "Body": "<p>I haven't been able to determine if there is a time sync process (such as <a href=\"https://en.wikipedia.org/wiki/Ntpd\" rel=\"nofollow noreferrer\">ntpd</a> or <a href=\"https://chrony.tuxfamily.org/\" rel=\"nofollow noreferrer\">chronyd</a>) running on the docker swarm I've deployed to AWS using <a href=\"https://docs.docker.com/docker-for-aws/\" rel=\"nofollow noreferrer\">Docker Community Edition (CE) for AWS</a>.</p>\n\n<ul>\n<li>I've ssh'd to a swarm manager, but <code>ps</code> doesn't show much, and I don't see anything in <code>/etc</code> or <code>/etc/conf.d</code> that looks relevant.</li>\n<li>I don't really have a good understanding of cloudformation, but I can see that the created instances running the docker nodes used AMI image <code>Moby Linux 18.09.2-ce-aws1 stable (ami-0f4fb04ea796afb9a)</code>. I created a new instance w/ that AMI so I could ssh there. Still no time sync process indications w/ <code>ps</code> or in <code>/etc</code></li>\n</ul>\n\n<p>I suppose one of the swarm control containers that is running may deal with sync'ing time (maybe <code>docker4x/l4controller-aws:18.09.2-ce-aws1</code>)? Or maybe the cloudformation template installed one on the instances? But I don't know how to verify that.</p>\n\n<p>So if anyone can tell me if there is a time sync process running (and where)?</p>\n\n<p>And if not, I feel there should be so how might I start one up?</p>\n", "OwnerUserId": "2184226", "LastActivityDate": "2019-10-17T02:05:03.453", "Title": "Is there a time sync process on the Docker for AWS nodes?", "Tags": "|amazon-web-services|docker|aws-cloudformation|docker-swarm|", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "207384383", "PostHistoryTypeId": "2", "PostId": "58421889", "RevisionGUID": "7406d401-17a3-479b-b7d0-0048e96312c3", "CreationDate": "2019-10-16T21:23:14.853", "UserId": "2184226", "Text": "I haven't been able to determine if there is a time sync process (such as [ntpd](https://en.wikipedia.org/wiki/Ntpd) or [chronyd](https://chrony.tuxfamily.org/)) running on the docker swarm I've deployed to AWS using [Docker Community Edition (CE) for AWS](https://docs.docker.com/docker-for-aws/).\r\n\r\n- I've ssh'd to a swarm manager, but `ps` doesn't show much, and I don't see anything in `/etc` or `/etc/conf.d` that looks relevant.\r\n- I don't really have a good understanding of cloudformation, but I can see that the created instances running the docker nodes used AMI image `Moby Linux 18.09.2-ce-aws1 stable (ami-0f4fb04ea796afb9a)`. I created a new instance w/ that AMI so I could ssh there. Still no time sync process indications w/ `ps` or in `/etc`\r\n\r\nI suppose one of the swarm control containers that is running may deal with sync'ing time (maybe `docker4x/l4controller-aws:18.09.2-ce-aws1`)? Or maybe the cloudformation template installed one on the instances? But I don't know how to verify that.\r\n\r\nSo if anyone can tell me if there is a time sync process running (and where)?\r\n\r\nAnd if not, I feel there should be so how might I start one up?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I created a new instance w/ that AMI so I could ssh there. ", "keywords": ["instance"]}]}, {"Id": "207384384", "PostHistoryTypeId": "1", "PostId": "58421889", "RevisionGUID": "7406d401-17a3-479b-b7d0-0048e96312c3", "CreationDate": "2019-10-16T21:23:14.853", "UserId": "2184226", "Text": "Is there a time sync process on the Docker for AWS nodes?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "207384385", "PostHistoryTypeId": "3", "PostId": "58421889", "RevisionGUID": "7406d401-17a3-479b-b7d0-0048e96312c3", "CreationDate": "2019-10-16T21:23:14.853", "UserId": "2184226", "Text": "|amazon-web-services|docker|aws-cloudformation|docker-swarm|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "58423901", "PostTypeId": "2", "ParentId": "58421889", "CreationDate": "2019-10-17T02:05:03.453", "Score": "1", "Body": "<p>You can verify resources that are created by cloud formation <a href=\"https://editions-us-east-1.s3.amazonaws.com/aws/stable/Docker-no-vpc.tmpl\" rel=\"nofollow noreferrer\">Docker-no-vpc.tmpl</a> from the link you provided.</p>\n\n<p>Second thing, do you think <code>ntpd</code> have something do with docker-swarm? or it should be installed on the underlying EC2 instance?</p>\n\n<p>Do ssh to your ec2 instance and very the status of the service, normally all AWS AMI has ntpd installed.\nor you can just type to check </p>\n\n<pre><code>ntpd\n</code></pre>\n\n<p>If you did not find, you can install it for your self or you can run docker swarm with custom AMI.</p>\n\n<blockquote>\n  <p>UCP requires that the system clocks on all the machines in a UCP\n  cluster be in sync or else it can start having issues checking the\n  status of the different nodes in the cluster. To ensure that the\n  clocks in a cluster are synced, you can use NTP to set each machine's\n  clock.</p>\n  \n  <p>First, on each machine in the cluster, install NTP. For example, to\n  install NTP on an Ubuntu distribution, run:</p>\n</blockquote>\n\n<pre><code>sudo apt-get update &amp;&amp; apt-get install ntp\n\n#On CentOS and RHEL, run:\n\nsudo yum install ntp\n</code></pre>\n\n<p><a href=\"https://success.docker.com/article/what-does-clock-skew-detected-mean\" rel=\"nofollow noreferrer\">what-does-clock-skew-detected-mean</a></p>\n\n<p>Last thing, do you really need the stack that is created by <a href=\"https://docs.docker.com/docker-for-aws/#docker-community-edition-ce-for-aws\" rel=\"nofollow noreferrer\">cloudformation</a>? </p>\n\n<pre><code>EC2 instances + Auto Scaling groups\nIAM profiles\nDynamoDB Tables\nSQS Queue\nVPC + subnets and security groups\nELB\nCloudWatch Log Group\n</code></pre>\n\n<p>I know the cloudformation ease our life, but if you do not know the template (what resouces will be created) do not try to run the template, otherwise you will bear  sweet cost at the of the month.</p>\n\n<p>Also will suggest exploring AWS <a href=\"https://aws.amazon.com/ecs/\" rel=\"nofollow noreferrer\">ECS</a> and <a href=\"https://aws.amazon.com/eks/\" rel=\"nofollow noreferrer\">EKS</a>, these are service that are sepcifly designed for docker container.</p>\n", "OwnerUserId": "3288890", "LastActivityDate": "2019-10-17T02:05:03.453", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "103408315", "PostId": "58423901", "Score": "0", "Text": "Sorry, but while interesting for topics unrelated to my question, this doesn't answer the question _is a time sync process running (and where)?_ at all. I mentioned ntpd only as an example of a time sync process I'm aware of, I don't care what is providing time synchronization, only whether it is happening or not.", "CreationDate": "2019-10-24T14:22:53.697", "UserId": "2184226", "filtered-sentences": []}], "history": [{"Id": "207392847", "PostHistoryTypeId": "2", "PostId": "58423901", "RevisionGUID": "09edfa45-6fc9-433f-adbb-c96bf01893dd", "CreationDate": "2019-10-17T02:05:03.453", "UserId": "3288890", "Text": "You can verify resources that are created by cloud formation [Docker-no-vpc.tmpl][1] from the link you provided.\r\n\r\n\r\nSecond thing, do you think `ntpd` have something do with docker-swarm? or it should be installed on the underlying EC2 instance?\r\n\r\n\r\nDo ssh to your ec2 instance and very the status of the service, normally all AWS AMI has ntpd installed.\r\nor you can just type to check \r\n\r\n```\r\nntpd\r\n```\r\n\r\nIf you did not find, you can install it for your self or you can run docker swarm with custom AMI.\r\n\r\n\r\n\r\n> UCP requires that the system clocks on all the machines in a UCP\r\n> cluster be in sync or else it can start having issues checking the\r\n> status of the different nodes in the cluster. To ensure that the\r\n> clocks in a cluster are synced, you can use NTP to set each machine's\r\n> clock.\r\n> \r\n> First, on each machine in the cluster, install NTP. For example, to\r\n> install NTP on an Ubuntu distribution, run:\r\n\r\n```\r\nsudo apt-get update && apt-get install ntp\r\n\r\n#On CentOS and RHEL, run:\r\n\r\nsudo yum install ntp\r\n```\r\n\r\n[what-does-clock-skew-detected-mean][2]\r\n\r\nLast thing, do you really need the stack that is created by [cloudformation][3]? \r\n\r\n```\r\nEC2 instances + Auto Scaling groups\r\nIAM profiles\r\nDynamoDB Tables\r\nSQS Queue\r\nVPC + subnets and security groups\r\nELB\r\nCloudWatch Log Group\r\n```\r\nI know the cloudformation ease our life, but if you do not know the template (what resouces will be created) do not try to run the template, otherwise you will bear  sweet cost at the of the month.\r\n\r\n\r\nAlso will suggest exploring AWS [ECS][4] and [EKS][5], these are service that are sepcifly designed for docker container.\r\n\r\n\r\n\r\n\r\n  [1]: https://editions-us-east-1.s3.amazonaws.com/aws/stable/Docker-no-vpc.tmpl\r\n  [2]: https://success.docker.com/article/what-does-clock-skew-detected-mean\r\n  [3]: https://docs.docker.com/docker-for-aws/#docker-community-edition-ce-for-aws\r\n  [4]: https://aws.amazon.com/ecs/\r\n  [5]: https://aws.amazon.com/eks/", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Second thing, do you think `ntpd` have something do with docker-swarm? or it should be installed on the underlying EC2 instance? ", "keywords": ["instance"]}, {"source": "Text", "text": "Do ssh to your ec2 instance and very the status of the service, normally all AWS AMI has ntpd installed. ", "keywords": ["instance"]}, {"source": "Text", "text": "> UCP requires that the system clocks on all the machines in a UCP > cluster be in sync or else it can start having issues checking the > status of the different nodes in the cluster. ", "keywords": ["cluster"]}, {"source": "Text", "text": "To ensure that the > clocks in a cluster are synced, you can use NTP to set each machine's > clock. ", "keywords": ["cluster"]}, {"source": "Text", "text": "> > First, on each machine in the cluster, install NTP. ", "keywords": ["cluster"]}, {"source": "Text", "text": "I know the cloudformation ease our life, but if you do not know the template (what resouces will be created) do not try to run the template, otherwise you will bear sweet cost at the of the month. ", "keywords": ["cost"]}]}], "filtered-sentences": [{"source": "Body", "text": "Second thing, do you think ntpd have something do with docker-swarm? or it should be installed on the underlying EC2 instance? ", "keywords": ["instance"]}, {"source": "Body", "text": "Do ssh to your ec2 instance and very the status of the service, normally all AWS AMI has ntpd installed. ", "keywords": ["instance"]}, {"source": "Body", "text": "UCP requires that the system clocks on all the machines in a UCP cluster be in sync or else it can start having issues checking the status of the different nodes in the cluster. ", "keywords": ["cluster"]}, {"source": "Body", "text": "To ensure that the clocks in a cluster are synced, you can use NTP to set each machine's clock. ", "keywords": ["cluster"]}, {"source": "Body", "text": "First, on each machine in the cluster, install NTP. ", "keywords": ["cluster"]}, {"source": "Body", "text": "I know the cloudformation ease our life, but if you do not know the template (what resouces will be created) do not try to run the template, otherwise you will bear sweet cost at the of the month. ", "keywords": ["cost"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I created a new instance w/ that AMI so I could ssh there. ", "keywords": ["instance"]}]}