{"Id": "75422633", "PostTypeId": "1", "AcceptedAnswerId": "75451444", "CreationDate": "2023-02-11T19:02:51.397", "Score": "1", "ViewCount": "961", "Body": "<p>I am having an issue while creating AWS::Appsync:Resolver Cloudformation in Serverless Framework using Javascript resolver.</p>\n<p>My <strong><code>Javascript Resolver</code></strong> code in root dir /src/resolvers/jsResolver.js which I have attached to <strong><code>AWS::AppSync::Resolver</code></strong> cloudformation in code block. I have also installed npm plugin for appsync utils in my package.json</p>\n<pre><code>import { util } from '@aws-appsync/utils';\n\n export function request(ctx) {\n    const {source, args} = ctx\n    return {\n    operation: 'Invoke',\n    payload: { field: ctx, arguments: args, source },\n  };\n}\n\nexport function response(ctx) {\n    util.error(&quot;Failed to fetch relatedPosts&quot;, &quot;LambdaFailure&quot;, ctx.prev.result)\n    return ctx.result;\n  }\n</code></pre>\n<p>My <strong><code>AWS::AppSync::Resolver</code></strong> Cloudformation is below in YML file also I have used Code as its Mandatory if I have declared it as <strong>APPSYNC_JS Runtime</strong></p>\n<pre><code>AppSyncJsResolver:\n  Type: AWS::AppSync::Resolver \n  Properties:\n    ApiId: !GettAtt Graphql.APiId\n    Kind: PIPELINE\n    Code: ./src/resolvers/jsResolver.js &lt;\u2014- Here my code is breaking up with error contains one or more error\n    TypeName: Query\n    FieldName: getInfo\n    Runtime:\n      Name: APPSYNC_JS\n      RuntimeVersion: 1.0.0\n    PipelineConfig:\n      Functions:\n        - !GetAtt AppSyncFunction.FunctionId \n</code></pre>\n<hr />\n<p>I have tried above code as per AWS Cloudformation documentation for Appsync available where they have mentioned that in <strong><code>AWS::AppSync::Resolver</code></strong> for creating Javascript Resolver using Cloudformation as below one of the properties. which I have included in my <strong><code>AWS::AppSync::Resolver</code></strong></p>\n<pre><code>Code  \n  The resolver code that contains the request and response functions. When code is \n  used, the runtime is required. The runtime value must be APPSYNC_JS.\n\nRequired: No\n\nType: String\n\nRequired: No\n\nType: String\n</code></pre>\n<hr />\n<p>So I've tried this and cant find enough solutions regarding Javascript Resolvers all are available with VTL template specific.</p>\n<p>With above code my CloudFormation build failed with the following error: An error occurred: <strong>AppSyncJSResolver- The code contains one or more errors.</strong>  (Service: AWSAppSync; Status Code: 400; Error Code: BadRequestException; Request ID: 0245d64d-...; Proxy: null)</p>\n<ul>\n<li>AppSyncJSResolver- which is my <strong><code>AWS::AppSync::Resolver</code></strong> in above code. and I have code property in that which giving me an error. I have verified with multiple sources and I am not finding any errors with my <strong>Javascript Resolver</strong> file /src/resolvers/jsResolver.js which I have declared in <strong>AppSyncJSResolver</strong> <strong><code>AWS::AppSync::Resolver</code></strong> in code property, I am not sure why I\u2019m getting this error, any help would be great.</li>\n</ul>\n", "OwnerUserId": "7700076", "LastEditorUserId": "7700076", "LastEditDate": "2023-02-13T22:51:05.853", "LastActivityDate": "2023-02-14T17:43:40.657", "Title": "AWS::Appsync:Resolver Cloudformation error using Javascript Resolver in Code block in YML using Serverless Framework", "Tags": "|javascript|amazon-web-services|aws-cloudformation|serverless-framework|aws-appsync-resolver|", "AnswerCount": "1", "CommentCount": "13", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "133093783", "PostId": "75422633", "Score": "0", "Text": "You shouldn't need to install utils anywhere. It's available in the environment already.", "CreationDate": "2023-02-13T00:21:51.723", "UserId": "9607540", "filtered-sentences": []}, {"Id": "133093854", "PostId": "75422633", "Score": "1", "Text": "It might be that if you want to have your code read from file you have to use the CodeS3Location parameter instead of the Code parameter which would treat it as an asset. I think the Code parameter expects inline code. You could also try inlining the code as it is short. I deploy from cdk and I can see it is using the CodeS3Location parameter in the CloudFormation output as my code is read from file.", "CreationDate": "2023-02-13T00:39:48.760", "UserId": "9607540", "filtered-sentences": []}, {"Id": "133093889", "PostId": "75422633", "Score": "1", "Text": "CodeS3Location value would look like: s3://my-bucket-name/my-filename.js The bucket name is probably some bucket SAM is using for deployment assets.", "CreationDate": "2023-02-13T00:46:45.170", "UserId": "9607540", "filtered-sentences": []}, {"Id": "133104033", "PostId": "75422633", "Score": "0", "Text": "Hello Graham thanks for your response, but don\u2019t you think if we use S3 bucket for this it will be costly so everytime our appsync make call it will also use resources in S3 which mean our resolver code so wouldn\u2019t it will make it bit costly. And also use storage in S3 bucket.", "CreationDate": "2023-02-13T14:46:57.013", "UserId": "7700076", "filtered-sentences": [{"source": "Text", "text": "And also use storage in S3 bucket.", "keywords": ["storage"]}]}, {"Id": "133105544", "PostId": "75422633", "Score": "1", "Text": "Code property under Appsync resolver expects a string or a JSON object that represents the code, not the location of the code file.\nYou can include it as a string in the Code parameter. \n\nOr as @GrahamHesketh suggested you use s3 to store your resolver files and point it to that location using the CodeS3Location parameter.", "CreationDate": "2023-02-13T15:57:49.353", "UserId": "12298581", "filtered-sentences": []}, {"Id": "133109228", "PostId": "75422633", "Score": "1", "Text": "@Cloudformation the code for the function is not called from S3 it is only stored there during the deployment phase at which point it is copied into the AppSync function where it is called so there is no lookup to S3 during its actual use. This is how code gets deployed from files in tools such as CDK or SAM and these files are knowns as assets.", "CreationDate": "2023-02-13T19:22:40.607", "UserId": "9607540", "filtered-sentences": []}, {"Id": "133110276", "PostId": "75422633", "Score": "0", "Text": "Thanks @GrahamHesketh and salt-pepper for your inputs that what I have thought initially but thanks for clearing out my doubts I will try with suggested solutions. I am getting response back with inline code for now. Now I will implement it using CodeS3Location. One more question how I will write test cases for those file which is gonna be on S3 bucket. Question is kinda silly one but wants to know its flow, as I am not gonna have that resolver js file on my VS code structure.", "CreationDate": "2023-02-13T20:37:42.947", "UserId": "7700076", "filtered-sentences": [{"source": "Text", "text": "One more question how I will write test cases for those file which is gonna be on S3 bucket. ", "keywords": ["test"]}]}, {"Id": "133110338", "PostId": "75422633", "Score": "0", "Text": "@GrahamHesketh also one follow up question with your previous response if the file in S3 will copied to appsync function, is it safe to remove file at some point let\u2019s say once we deploy our code or we need to keep it. Please also advice how I will write test cases for those resolver files. Thanks", "CreationDate": "2023-02-13T20:42:46.847", "UserId": "7700076", "filtered-sentences": [{"source": "Text", "text": "Please also advice how I will write test cases for those resolver files. ", "keywords": ["test"]}]}, {"Id": "133120822", "PostId": "75422633", "Score": "0", "Text": "Disclaimer, I don't work with SAM so it may be different but I'm guessing it follows very similar principles to CDK. You have a project locally where you write the file and can do local testing prior to deployment, and/or deploy the project to a sandbox cloud environment for testing. The code file will regularly reside in a special bucket reserved for cloud deployments and the \"sam deploy\" command will send it there on your behalf. You don't manage the file being deployed to S3. The cost of storing it there will be negligible.", "CreationDate": "2023-02-14T12:11:16.170", "UserId": "9607540", "filtered-sentences": [{"source": "Text", "text": "You have a project locally where you write the file and can do local testing prior to deployment, and/or deploy the project to a sandbox cloud environment for testing. ", "keywords": ["test"]}, {"source": "Text", "text": "The cost of storing it there will be negligible.", "keywords": ["cost"]}]}, {"Id": "133120896", "PostId": "75422633", "Score": "0", "Text": "Have a read of how the \"sam package\" and \"sam deploy\" commands work, note \"sam deploy\" will run \"sam package\" on your behalf. \nhttps://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-cli-command-reference-sam-package.html\n\nhttps://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-cli-command-reference-sam-deploy.html", "CreationDate": "2023-02-14T12:14:36.723", "UserId": "9607540", "filtered-sentences": []}, {"Id": "133123347", "PostId": "75422633", "Score": "0", "Text": "@GrahamHesketh I am not using SAM for my deployment I am using Serverless Framework to deploy code from locally to cloud. I have used cloudformation for JavaScript resolver since their plugin doesn\u2019t have support for it yet. So most of js/node files for testing more like unit testing I have locally on VS.", "CreationDate": "2023-02-14T14:24:10.400", "UserId": "7700076", "filtered-sentences": [{"source": "Text", "text": "So most of js/node files for testing more like unit testing I have locally on VS.", "keywords": ["test"]}]}, {"Id": "133124113", "PostId": "75422633", "Score": "0", "Text": "Oh ok, still similar concepts should hold in serverless framework. They are all just wrappers for cloudformation at the end of the day. Word of advice from early experience, the JS env in AppSync functions is quite different from what you might expect in node running on your machine. They have limited functionality and so it is worth testing functions in a deployed sandbox and/or in the console.", "CreationDate": "2023-02-14T15:02:28.980", "UserId": "9607540", "filtered-sentences": [{"source": "Text", "text": "They have limited functionality and so it is worth testing functions in a deployed sandbox and/or in the console.", "keywords": ["test"]}]}, {"Id": "133127374", "PostId": "75422633", "Score": "1", "Text": "@GrahamHesketh: I have responded with answers thanks for your suggestions. hope this will help to others.", "CreationDate": "2023-02-14T17:45:38.897", "UserId": "7700076", "filtered-sentences": []}], "history": [{"Id": "287900230", "PostHistoryTypeId": "2", "PostId": "75422633", "RevisionGUID": "efca0502-5653-429b-85f8-f347ca045bfd", "CreationDate": "2023-02-11T19:02:51.397", "UserId": "7700076", "Text": "I am having an issue while creating AWS::Appsync:FunctionConfiguration Cloudformation in Serverless Framework using Javascript resolver. My **`AWS::AppSync::DataSource`** is below in YML file\r\n\r\n    GetJsDataSource:\r\n      Type: AWS::AppSync::DataSource\r\n      Properties: \r\n        ApiId: !GettAtt Graphql.APiId\r\n        Description: This Getjs lambda datasource\r\n        LambdaConfig: \r\n          LambdaFunctionArn: ${self:custom.lambda.getJs.arn}\r\n        ServiceRoleArn: ${self:custom.role.lambda.arn}\r\n        Name: getJs\r\n        Type: AWS_LAMBDA \r\n\r\nMy **`AWS::AppSync::FunctionConfiguration`** cloudformation is below in YML \r\n\r\n    AppSyncFunction:\r\n      Type: AWS::AppSync::FunctionConfiguration\r\n      Properties:\r\n        ApiId: !GettAtt Graphql.APiId\r\n        Code: ./src/resolvers/jsResolver.js <-- Here where my cloudformation is breaking up with error like code contains one or more error\r\n        DataSourceName: !GetAtt GetJsDataSource.Name\r\n        Name: GetJsFunction\r\n        Description: This is getJs \r\n        Runtime: \r\n          Name: APPSYNC_JS\r\n          RuntimeVersion: 1.0.0\r\n\r\n\r\nMy **`Javascript Resolver`** code in root dir /src/resolvers/jsResolver.js which I have attached to **`AWS::AppSync::FunctionConfiguration`** cloudformation in code block. I have also installed npm plugin for appsync utils in my package.json \r\n\r\n    import { util } from '@aws-appsync/utils';\r\n\r\n     export function request(ctx) {\r\n        const {source, args} = ctx\r\n        return {\r\n        operation: 'Invoke',\r\n        payload: { field: ctx, arguments: args, source },\r\n      };\r\n    }\r\n    \r\n    export function response(ctx) {\r\n        util.error(\"Failed to fetch relatedPosts\", \"LambdaFailure\", ctx.prev.result)\r\n        return ctx.result;\r\n      }\r\n\r\n\r\nMy **`AWS::AppSync::Resolver`** Cloudformation is below in YML file also I have used Code as its Mandatory if I have declared it as **APPSYNC_JS Runtime** \r\n\r\n    AppSyncJsResolver:\r\n      Type: AWS::AppSync::Resolver \r\n      Properties:\r\n        ApiId: !GettAtt Graphql.APiId\r\n        Kind: PIPELINE\r\n        Code: ./src/resolvers/jsResolver.js\r\n        TypeName: Query\r\n        FieldName: getBooking\r\n        Runtime:\r\n          Name: APPSYNC_JS\r\n          RuntimeVersion: 1.0.0\r\n        PipelineConfig:\r\n          Functions:\r\n            - !GetAtt AppSyncFunction.FunctionId \r\n\r\n\r\n----------\r\n\r\nI have tried above code as per AWS Cloudformation documentation for Appsync available where they have mentioned that in **`AWS::AppSync::FunctionConfiguration`** for creating Javascript Resolver using Cloudformation as below one of the properties. which I have include in my **`AWS::AppSync::FunctionConfiguration`** \r\n\r\n    Code  \r\n      The resolver code that contains the request and response functions. When code is \r\n      used, the runtime is required. The runtime value must be APPSYNC_JS.\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n\r\n------\r\n\r\nSo I've tried this and cant find enough solutions regarding Javascript Resolvers all are available with VTL template specific.\r\n\r\nWith above code my CloudFormation build failed with the following error: An error occurred: **AppSyncFunction- The code contains one or more errors.**  (Service: AWSAppSync; Status Code: 400; Error Code: BadRequestException; Request ID: 0245d64d-...; Proxy: null)\r\n\r\n* AppSyncFunction- which is my **`AWS::AppSync::FunctionConfiguration`** in above code. and I have code property in that which giving me an error. I have verified with multiple sources and I am not finding any errors with my **Javascript Resolver** file /src/resolvers/jsResolver.js which I have declared in **AppSyncFunction** **`AWS::AppSync::FunctionConfiguration`** in code property, I am not sure why I getting this error, any help would be great.\r\n\r\n\r\n  [1]: http://\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "287900232", "PostHistoryTypeId": "1", "PostId": "75422633", "RevisionGUID": "efca0502-5653-429b-85f8-f347ca045bfd", "CreationDate": "2023-02-11T19:02:51.397", "UserId": "7700076", "Text": "AWS::Appsync:FunctionConfiguration Cloudformation error using Javascript Resolver in Code block in YML using Serverless Framework", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "287900233", "PostHistoryTypeId": "3", "PostId": "75422633", "RevisionGUID": "efca0502-5653-429b-85f8-f347ca045bfd", "CreationDate": "2023-02-11T19:02:51.397", "UserId": "7700076", "Text": "|javascript|amazon-web-services|aws-cloudformation|serverless-framework|aws-appsync-resolver|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "287939220", "PostHistoryTypeId": "5", "PostId": "75422633", "RevisionGUID": "f7aa96f0-ea18-4d44-bf09-695022d2fc63", "CreationDate": "2023-02-12T18:39:02.673", "UserId": "7700076", "Comment": "Changed my code and added code to resolver", "Text": "I am having an issue while creating AWS::Appsync:Resolver Cloudformation in Serverless Framework using Javascript resolver. My **`AWS::AppSync::DataSource`** is below in YML file\r\n\r\n    GetJsDataSource:\r\n      Type: AWS::AppSync::DataSource\r\n      Properties: \r\n        ApiId: !GettAtt Graphql.APiId\r\n        Description: This Getjs lambda datasource\r\n        LambdaConfig: \r\n          LambdaFunctionArn: ${self:custom.lambda.getJs.arn}\r\n        ServiceRoleArn: ${self:custom.role.lambda.arn}\r\n        Name: getJs\r\n        Type: AWS_LAMBDA \r\n\r\nMy **`AWS::AppSync::FunctionConfiguration`** cloudformation is below in YML \r\n\r\n    AppSyncFunction:\r\n      Type: AWS::AppSync::FunctionConfiguration\r\n      Properties:\r\n        ApiId: !GettAtt Graphql.APiId\r\n        DataSourceName: !GetAtt GetJsDataSource.Name\r\n        Name: GetJsFunction\r\n        Description: This is getJs\r\n        FunctionVersion: \"2018-05-29\"\r\n\r\n \r\n\r\n\r\nMy **`Javascript Resolver`** code in root dir /src/resolvers/jsResolver.js which I have attached to **`AWS::AppSync::Resolver`** cloudformation in code block. I have also installed npm plugin for appsync utils in my package.json \r\n\r\n    import { util } from '@aws-appsync/utils';\r\n\r\n     export function request(ctx) {\r\n        const {source, args} = ctx\r\n        return {\r\n        operation: 'Invoke',\r\n        payload: { field: ctx, arguments: args, source },\r\n      };\r\n    }\r\n    \r\n    export function response(ctx) {\r\n        util.error(\"Failed to fetch relatedPosts\", \"LambdaFailure\", ctx.prev.result)\r\n        return ctx.result;\r\n      }\r\n\r\n\r\nMy **`AWS::AppSync::Resolver`** Cloudformation is below in YML file also I have used Code as its Mandatory if I have declared it as **APPSYNC_JS Runtime** \r\n\r\n    AppSyncJsResolver:\r\n      Type: AWS::AppSync::Resolver \r\n      Properties:\r\n        ApiId: !GettAtt Graphql.APiId\r\n        Kind: PIPELINE\r\n        Code: ./src/resolvers/jsResolver.js <\u2014- Here my code is breaking up with error contains one or more error\r\n        TypeName: Query\r\n        FieldName: getBooking\r\n        Runtime:\r\n          Name: APPSYNC_JS\r\n          RuntimeVersion: 1.0.0\r\n        PipelineConfig:\r\n          Functions:\r\n            - !GetAtt AppSyncFunction.FunctionId \r\n\r\n\r\n----------\r\n\r\nI have tried above code as per AWS Cloudformation documentation for Appsync available where they have mentioned that in **`AWS::AppSync::Resolver`** for creating Javascript Resolver using Cloudformation as below one of the properties. which I have included in my **`AWS::AppSync::Resolver`** \r\n\r\n    Code  \r\n      The resolver code that contains the request and response functions. When code is \r\n      used, the runtime is required. The runtime value must be APPSYNC_JS.\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n\r\n------\r\n\r\nSo I've tried this and cant find enough solutions regarding Javascript Resolvers all are available with VTL template specific.\r\n\r\nWith above code my CloudFormation build failed with the following error: An error occurred: **AppSyncJSResolver- The code contains one or more errors.**  (Service: AWSAppSync; Status Code: 400; Error Code: BadRequestException; Request ID: 0245d64d-...; Proxy: null)\r\n\r\n* AppSyncJSResolver- which is my **`AWS::AppSync::Resolver`** in above code. and I have code property in that which giving me an error. I have verified with multiple sources and I am not finding any errors with my **Javascript Resolver** file /src/resolvers/jsResolver.js which I have declared in **AppSyncJSResolver** **`AWS::AppSync::Resolver`** in code property, I am not sure why I\u2019m getting this error, any help would be great.\r\n\r\n\r\n  [1]: http://\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Comment", "text": "Changed my code and added code to resolver", "keywords": ["change"]}]}, {"Id": "287939221", "PostHistoryTypeId": "4", "PostId": "75422633", "RevisionGUID": "f7aa96f0-ea18-4d44-bf09-695022d2fc63", "CreationDate": "2023-02-12T18:39:02.673", "UserId": "7700076", "Comment": "Changed my code and added code to resolver", "Text": "AWS::Appsync:Resolver Cloudformation error using Javascript Resolver in Code block in YML using Serverless Framework", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Comment", "text": "Changed my code and added code to resolver", "keywords": ["change"]}]}, {"Id": "288011562", "PostHistoryTypeId": "5", "PostId": "75422633", "RevisionGUID": "0ca44a33-885c-44d6-96df-f02b4d47163b", "CreationDate": "2023-02-13T22:51:05.853", "UserId": "7700076", "Comment": "deleted 792 characters in body", "Text": "I am having an issue while creating AWS::Appsync:Resolver Cloudformation in Serverless Framework using Javascript resolver. \r\n\r\nMy **`Javascript Resolver`** code in root dir /src/resolvers/jsResolver.js which I have attached to **`AWS::AppSync::Resolver`** cloudformation in code block. I have also installed npm plugin for appsync utils in my package.json \r\n\r\n    import { util } from '@aws-appsync/utils';\r\n\r\n     export function request(ctx) {\r\n        const {source, args} = ctx\r\n        return {\r\n        operation: 'Invoke',\r\n        payload: { field: ctx, arguments: args, source },\r\n      };\r\n    }\r\n    \r\n    export function response(ctx) {\r\n        util.error(\"Failed to fetch relatedPosts\", \"LambdaFailure\", ctx.prev.result)\r\n        return ctx.result;\r\n      }\r\n\r\n\r\nMy **`AWS::AppSync::Resolver`** Cloudformation is below in YML file also I have used Code as its Mandatory if I have declared it as **APPSYNC_JS Runtime** \r\n\r\n    AppSyncJsResolver:\r\n      Type: AWS::AppSync::Resolver \r\n      Properties:\r\n        ApiId: !GettAtt Graphql.APiId\r\n        Kind: PIPELINE\r\n        Code: ./src/resolvers/jsResolver.js <\u2014- Here my code is breaking up with error contains one or more error\r\n        TypeName: Query\r\n        FieldName: getInfo\r\n        Runtime:\r\n          Name: APPSYNC_JS\r\n          RuntimeVersion: 1.0.0\r\n        PipelineConfig:\r\n          Functions:\r\n            - !GetAtt AppSyncFunction.FunctionId \r\n\r\n\r\n----------\r\n\r\nI have tried above code as per AWS Cloudformation documentation for Appsync available where they have mentioned that in **`AWS::AppSync::Resolver`** for creating Javascript Resolver using Cloudformation as below one of the properties. which I have included in my **`AWS::AppSync::Resolver`** \r\n\r\n    Code  \r\n      The resolver code that contains the request and response functions. When code is \r\n      used, the runtime is required. The runtime value must be APPSYNC_JS.\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n    \r\n    Required: No\r\n    \r\n    Type: String\r\n\r\n------\r\n\r\nSo I've tried this and cant find enough solutions regarding Javascript Resolvers all are available with VTL template specific.\r\n\r\nWith above code my CloudFormation build failed with the following error: An error occurred: **AppSyncJSResolver- The code contains one or more errors.**  (Service: AWSAppSync; Status Code: 400; Error Code: BadRequestException; Request ID: 0245d64d-...; Proxy: null)\r\n\r\n* AppSyncJSResolver- which is my **`AWS::AppSync::Resolver`** in above code. and I have code property in that which giving me an error. I have verified with multiple sources and I am not finding any errors with my **Javascript Resolver** file /src/resolvers/jsResolver.js which I have declared in **AppSyncJSResolver** **`AWS::AppSync::Resolver`** in code property, I am not sure why I\u2019m getting this error, any help would be great.\r\n\r\n\r\n  [1]: http://\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "75451444", "PostTypeId": "2", "ParentId": "75422633", "CreationDate": "2023-02-14T17:43:40.657", "Score": "2", "Body": "<p>To answering my own question, The way I resolve it via two ways.</p>\n<p><strong>1.</strong> We can write whole Resolver code in YML Cloudformation in <strong>Code property</strong>  like below. Make sure your resolver code <strong>should be inside of your Code property</strong> and use <strong>&quot;|&quot; special character (Multi-line code)</strong> after Code property.</p>\n<blockquote>\n<pre><code>AppSyncJsResolver:\n  Type: AWS::AppSync::Resolver \n  Properties:\n    ApiId: !GettAtt Graphql.APiId\n    Kind: PIPELINE\n    Code: | \n         import { util } from '@aws-appsync/utils';\n         export function request(ctx) {\n         const {source, args} = ctx\n         return {\n         operation: 'Invoke',\n         payload: { field: ctx, arguments: args, source },\n        };\n        }\n        export function response(ctx) {\n        util.error(&quot;Failed to fetch relatedPosts&quot;, &quot;LambdaFailure&quot;,ctx.prev.result)\n        return ctx.result;\n        }\n    TypeName: Query\n    FieldName: getInfo\n    Runtime:\n      Name: APPSYNC_JS\n      RuntimeVersion: 1.0.0\n    PipelineConfig:\n      Functions:\n        - !GetAtt AppSyncFunction.FunctionId\n</code></pre>\n</blockquote>\n<p><strong>2.</strong> If you want to <strong>keep your business logic out of YML</strong> file and keep it separate then you can use <strong>CodeS3Location</strong> property in your javascript resolver like below.</p>\n<p>first <strong>create bucket in S3</strong> and store your javascript resolver file with your resolver code in bucket. make sure you give enough IAM permission to your appsync to access your S3 bucket.</p>\n<p>After above step you can rewrite your YML Cloudformation like below</p>\n<blockquote>\n<pre><code>AppSyncJsResolver:\n  Type: AWS::AppSync::Resolver \n  Properties:\n    ApiId: !GettAtt Graphql.APiId\n    Kind: PIPELINE\n    CodeS3Location:s3://my-bucket-name/my-filename.js\n    TypeName: Query\n    FieldName: getInfo\n    Runtime:\n      Name: APPSYNC_JS\n      RuntimeVersion: 1.0.0\n    PipelineConfig:\n      Functions:\n        - !GetAtt AppSyncFunction.FunctionId\n</code></pre>\n</blockquote>\n<p>Hope this help others and will contribute more about Javascript Resolver so it will be easier for other to find more complex solutions and get as much as resources about Javascript Resolver. Thanks to @Graham Hesketh for your suggestions.</p>\n", "OwnerUserId": "7700076", "LastActivityDate": "2023-02-14T17:43:40.657", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "288064999", "PostHistoryTypeId": "2", "PostId": "75451444", "RevisionGUID": "54696381-b802-4526-b547-a06e6c5ff07f", "CreationDate": "2023-02-14T17:43:40.657", "UserId": "7700076", "Text": "To answering my own question, The way I resolve it via two ways. \r\n\r\n**1.** We can write whole Resolver code in YML Cloudformation in **Code property**  like below. Make sure your resolver code **should be inside of your Code property** and use **\"|\" special character (Multi-line code)** after Code property.\r\n\r\n\r\n\r\n\r\n>     AppSyncJsResolver:\r\n>       Type: AWS::AppSync::Resolver \r\n>       Properties:\r\n>         ApiId: !GettAtt Graphql.APiId\r\n>         Kind: PIPELINE\r\n>         Code: | \r\n>              import { util } from '@aws-appsync/utils';\r\n>              export function request(ctx) {\r\n>              const {source, args} = ctx\r\n>              return {\r\n>              operation: 'Invoke',\r\n>              payload: { field: ctx, arguments: args, source },\r\n>             };\r\n>             }\r\n>             export function response(ctx) {\r\n>             util.error(\"Failed to fetch relatedPosts\", \"LambdaFailure\",ctx.prev.result)\r\n>             return ctx.result;\r\n>             }\r\n>         TypeName: Query\r\n>         FieldName: getInfo\r\n>         Runtime:\r\n>           Name: APPSYNC_JS\r\n>           RuntimeVersion: 1.0.0\r\n>         PipelineConfig:\r\n>           Functions:\r\n>             - !GetAtt AppSyncFunction.FunctionId\r\n\r\n\r\n**2.** If you want to **keep your business logic out of YML** file and keep it separate then you can use **CodeS3Location** property in your javascript resolver like below.\r\n\r\nfirst **create bucket in S3** and store your javascript resolver file with your resolver code in bucket. make sure you give enough IAM permission to your appsync to access your S3 bucket. \r\n\r\nAfter above step you can rewrite your YML Cloudformation like below\r\n\r\n>     AppSyncJsResolver:\r\n>       Type: AWS::AppSync::Resolver \r\n>       Properties:\r\n>         ApiId: !GettAtt Graphql.APiId\r\n>         Kind: PIPELINE\r\n>         CodeS3Location:s3://my-bucket-name/my-filename.js\r\n>         TypeName: Query\r\n>         FieldName: getInfo\r\n>         Runtime:\r\n>           Name: APPSYNC_JS\r\n>           RuntimeVersion: 1.0.0\r\n>         PipelineConfig:\r\n>           Functions:\r\n>             - !GetAtt AppSyncFunction.FunctionId\r\n\r\nHope this help others and will contribute more about Javascript Resolver so it will be easier for other to find more complex solutions and get as much as resources about Javascript Resolver. Thanks to @Graham Hesketh for your suggestions.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}