{"Id": "74271766", "PostTypeId": "1", "CreationDate": "2022-11-01T05:08:54.207", "Score": "0", "ViewCount": "416", "Body": "<p>I created an AWS CloudWatch Alarm that monitors multiple Lambda functions and triggers in case of error in any Lambda.</p>\n<p>Alarm is working as expected if there is only one Lambda function (<code>Dimensions</code>)</p>\n<pre><code>Dimensions:\n      - Name: FunctionName\n        Value: invoice-lambda-function\n</code></pre>\n<p>In case of multiple Lambda functions (<code>Dimensions</code>) it's erroring while creating the CloudFormation Stack</p>\n<pre><code>Dimensions:\n      - Name: FunctionName\n        Value: invoice-lambda-function\n      - Name: FunctionName\n        Value: bill-lambda-function\n      - Name: FunctionName\n        Value: payment-lambda-function\n</code></pre>\n<p>Error:\n<code>Dimension names must be unique (duplicate: FunctionName) (Service: AmazonCloudWatch; Status Code: 400; Error Code: ValidationError; Request ID: ca4d0fb5-5f7c-48d1-a49e-3012f294655e; Proxy: null)</code></p>\n<p><strong>AWS CloudFormation Template </strong></p>\n<pre><code>ErrorNotificationAlarm:\n  Type: 'AWS::CloudWatch::Alarm'\n  Properties:\n    AlarmDescription: Send error notification\n    Namespace: AWS/Lambda\n    MetricName: Errors\n    ComparisonOperator: GreaterThanThreshold\n    EvaluationPeriods: '1'\n    Period: '60'\n    Statistic: Sum\n    Threshold: '0'\n    AlarmActions:\n    - !Ref ErrorTopic\n    Dimensions:\n      - Name: FunctionName\n        Value: invoice-lambda-function\n      - Name: FunctionName\n        Value: bill-lambda-function\n      - Name: FunctionName\n        Value: payment-lambda-function\n  ErrorTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      DisplayName: ErrorTopic\n  ErrorTopicSubscription:\n    Type: AWS::SNS::Subscription\n    Properties:\n      Endpoint: xxxxx@gmail.com\n      Protocol: email\n      TopicArn: !Ref ErrorTopic\n</code></pre>\n<ul>\n<li>Is my Syntax correct?</li>\n<li>Doesn't the Alarm work for multiple similar (<code>FunctionName</code>) Dimenions?</li>\n</ul>\n", "OwnerUserId": "12857755", "LastActivityDate": "2022-11-01T06:14:25.567", "Title": "AWS::CloudWatch::Alarm - AWS CloudFormation - not working for multiple Dimensions", "Tags": "|amazon-web-services|aws-cloudformation|cloudwatch-alarms|", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "281260362", "PostHistoryTypeId": "2", "PostId": "74271766", "RevisionGUID": "76a9fa3e-7a26-4403-b3e5-f703d4a23f4e", "CreationDate": "2022-11-01T05:08:54.207", "UserId": "12857755", "Text": "I created an AWS CloudWatch Alarm that monitors multiple Lambda functions and triggers in case of error in any Lambda.\r\n\r\nAlarm is working as expected if there is only one Lambda function (`Dimensions`)\r\n```\r\nDimensions:\r\n      - Name: FunctionName\r\n        Value: invoice-lambda-function\r\n```\r\n\r\nIn case of multiple Lambda functions (`Dimensions`) it's erroring while creating the CloudFormation Stack\r\n\r\n```\r\nDimensions:\r\n      - Name: FunctionName\r\n        Value: invoice-lambda-function\r\n      - Name: FunctionName\r\n        Value: bill-lambda-function\r\n      - Name: FunctionName\r\n        Value: payment-lambda-function\r\n```\r\nError:\r\n`Dimension names must be unique (duplicate: FunctionName) (Service: AmazonCloudWatch; Status Code: 400; Error Code: ValidationError; Request ID: ca4d0fb5-5f7c-48d1-a49e-3012f294655e; Proxy: null)`\r\n\r\n**AWS CloudFormation Template **\r\n```\r\nErrorNotificationAlarm:\r\n  Type: 'AWS::CloudWatch::Alarm'\r\n  Properties:\r\n    AlarmDescription: Send error notification\r\n    Namespace: AWS/Lambda\r\n    MetricName: Errors\r\n    ComparisonOperator: GreaterThanThreshold\r\n    EvaluationPeriods: '1'\r\n    Period: '60'\r\n    Statistic: Sum\r\n    Threshold: '0'\r\n    AlarmActions:\r\n    - !Ref ErrorTopic\r\n    Dimensions:\r\n      - Name: FunctionName\r\n        Value: invoice-lambda-function\r\n      - Name: FunctionName\r\n        Value: bill-lambda-function\r\n      - Name: FunctionName\r\n        Value: payment-lambda-function\r\n  ErrorTopic:\r\n    Type: AWS::SNS::Topic\r\n    Properties:\r\n      DisplayName: ErrorTopic\r\n  ErrorTopicSubscription:\r\n    Type: AWS::SNS::Subscription\r\n    Properties:\r\n      Endpoint: xxxxx@gmail.com\r\n      Protocol: email\r\n      TopicArn: !Ref ErrorTopic\r\n```\r\n\r\n - Is my Syntax correct?\r\n - Doesn't the Alarm work for multiple similar (`FunctionName`) Dimenions?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Alarm is working as expected if there is only one Lambda function (`Dimensions`) ``` Dimensions: - Name: FunctionName Value: invoice-lambda-function ``` In case of multiple Lambda functions (`Dimensions`) it's erroring while creating the CloudFormation Stack ``` Dimensions: - Name: FunctionName Value: invoice-lambda-function - Name: FunctionName Value: bill-lambda-function - Name: FunctionName Value: payment-lambda-function ``` Error: `Dimension names must be unique (duplicate: FunctionName) (Service: AmazonCloudWatch; Status Code: 400; Error Code: ValidationError; Request ID: ca4d0fb5-5f7c-48d1-a49e-3012f294655e; Proxy: null)` ", "keywords": ["bill"]}, {"source": "Text", "text": "**AWS CloudFormation Template ** ``` ErrorNotificationAlarm: Type: 'AWS::CloudWatch::Alarm' Properties: AlarmDescription: Send error notification Namespace: AWS/Lambda MetricName: Errors ComparisonOperator: GreaterThanThreshold EvaluationPeriods: '1' Period: '60' Statistic: Sum Threshold: '0' AlarmActions: - !Ref ErrorTopic Dimensions: - Name: FunctionName Value: invoice-lambda-function - Name: FunctionName Value: bill-lambda-function - Name: FunctionName Value: payment-lambda-function ErrorTopic: Type: AWS::SNS::Topic Properties: DisplayName: ErrorTopic ErrorTopicSubscription: Type: AWS::SNS::Subscription Properties: Endpoint: xxxxx@gmail.com Protocol: email TopicArn: !Ref ErrorTopic ``` - Is my Syntax correct? - Doesn't the Alarm work for multiple similar (`FunctionName`) Dimenions?", "keywords": ["bill"]}]}, {"Id": "281260364", "PostHistoryTypeId": "1", "PostId": "74271766", "RevisionGUID": "76a9fa3e-7a26-4403-b3e5-f703d4a23f4e", "CreationDate": "2022-11-01T05:08:54.207", "UserId": "12857755", "Text": "AWS::CloudWatch::Alarm - AWS CloudFormation - not working for multiple Dimensions", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "281260365", "PostHistoryTypeId": "3", "PostId": "74271766", "RevisionGUID": "76a9fa3e-7a26-4403-b3e5-f703d4a23f4e", "CreationDate": "2022-11-01T05:08:54.207", "UserId": "12857755", "Text": "|amazon-web-services|aws-cloudformation|cloudwatch-alarms|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "74272154", "PostTypeId": "2", "ParentId": "74271766", "CreationDate": "2022-11-01T06:14:25.567", "Score": "2", "Body": "<p>You can't use three same dimensions equal to <code>FunctionName</code>. If you want to summarize multiple metrics for different functions you have to use <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/using-metric-math.html\" rel=\"nofollow noreferrer\">metric math</a> to aggravate the metrics from the three functions into a single metric.</p>\n", "OwnerUserId": "248823", "LastActivityDate": "2022-11-01T06:14:25.567", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "281262497", "PostHistoryTypeId": "2", "PostId": "74272154", "RevisionGUID": "a2f197f4-7824-4512-9536-a0fc49702794", "CreationDate": "2022-11-01T06:14:25.567", "UserId": "248823", "Text": "You can't use three same dimensions equal to `FunctionName`. If you want to summarize multiple metrics for different functions you have to use [metric math](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/using-metric-math.html) to aggravate the metrics from the three functions into a single metric. ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": false, "filtered-sentences": []}