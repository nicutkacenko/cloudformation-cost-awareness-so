{"Id": "53652549", "PostTypeId": "1", "AcceptedAnswerId": "53975902", "CreationDate": "2018-12-06T13:29:06.690", "Score": "27", "ViewCount": "18896", "Body": "<p>I've seen this <a href=\"https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/\" rel=\"noreferrer\">site</a> about DynamoDB On-demand and I updated my tables, created by CloudFormation, to On-demand. Now, when I try to update my Stack, I get this error:</p>\n\n<blockquote>\n  <p>One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST</p>\n</blockquote>\n\n<p>Is there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I've updated to On-demand on AWS Console.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>My template:</p>\n\n<pre><code>DynamoDBUsersTable:\n    Type: AWS::DynamoDB::Table\n    Description: Users table\n    Properties:\n      TableName: !Sub ${StackName}-users-table\n      AttributeDefinitions:\n        - AttributeName: userId\n          AttributeType: S\n      KeySchema:\n        - AttributeName: userId\n          KeyType: HASH\n      ProvisionedThroughput:\n        ReadCapacityUnits: 10\n        WriteCapacityUnits: 10\n</code></pre>\n\n<p>Thank you. </p>\n", "OwnerUserId": "8786986", "LastEditorUserId": "8786986", "LastEditDate": "2018-12-06T15:21:53.840", "LastActivityDate": "2018-12-30T07:20:36.190", "Title": "How to set DynamoDB Read/write capacity mode to On-demand on CloudFormation", "Tags": "|amazon-web-services|amazon-dynamodb|aws-cloudformation|", "AnswerCount": "1", "CommentCount": "11", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "94164044", "PostId": "53652549", "Score": "0", "Text": "Based on the error, it appears you are *almost* doing what you want, but you are failing to clear the old RCU settings.  What does this section of your CFN template look like?", "CreationDate": "2018-12-06T13:50:40.170", "UserId": "1695906", "filtered-sentences": []}, {"Id": "94164099", "PostId": "53652549", "Score": "0", "Text": "The template is this way:\n` ProvisionedThroughput:\n   ReadCapacityUnits: 2\n   WriteCapacityUnits: 2`. Also, I've tried putting 0 instead 2 and removing ProvisionedThroughput.", "CreationDate": "2018-12-06T13:52:00.873", "UserId": "8786986", "filtered-sentences": []}, {"Id": "94164367", "PostId": "53652549", "Score": "1", "Text": "Removing `ProvisionedThroughput` is correct, according to [docs](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html).  Also you'd need to have removed any auto-scaling.  What is the error with `ProvisionedThroughput` removed?  It should be different than the one in the question.", "CreationDate": "2018-12-06T13:59:06.547", "UserId": "1695906", "filtered-sentences": []}, {"Id": "94164482", "PostId": "53652549", "Score": "0", "Text": "@Michael-sqlbot in a table without On-demand, I had this error when I remove `ProvisionedThroughput` : > Internal Failure", "CreationDate": "2018-12-06T14:02:00.140", "UserId": "8786986", "filtered-sentences": []}, {"Id": "94164584", "PostId": "53652549", "Score": "0", "Text": "@Michael-sqlbot I updated the answer. \"I've updated to On-demand on AWS Console.\"", "CreationDate": "2018-12-06T14:04:29.813", "UserId": "8786986", "filtered-sentences": []}, {"Id": "94166854", "PostId": "53652549", "Score": "0", "Text": "Since this as a problem that can no longer be reproduced, you may want to consider deleting the question.", "CreationDate": "2018-12-06T15:01:23.423", "UserId": "1695906", "filtered-sentences": []}, {"Id": "94167371", "PostId": "53652549", "Score": "0", "Text": "@Michael-sqlbot. I've seen the docs you sent and there explain about BillingMode. I think I was seeing an older version. Do you want to answer this question with the link you sent?", "CreationDate": "2018-12-06T15:15:30.587", "UserId": "8786986", "filtered-sentences": []}, {"Id": "94167511", "PostId": "53652549", "Score": "0", "Text": "I would, but we don't have a way to confirm whether it works as expected, at this point.", "CreationDate": "2018-12-06T15:19:32.843", "UserId": "1695906", "filtered-sentences": []}, {"Id": "94167767", "PostId": "53652549", "Score": "1", "Text": "I think the AWS team is updating CloudFormation. I had this error when I added `BillingMode`: \"Encountered unsupported property BillingMode\". I'll wait and try again next days. Thank you @Michael-sqlbot", "CreationDate": "2018-12-06T15:27:33.680", "UserId": "8786986", "filtered-sentences": []}, {"Id": "98844322", "PostId": "53652549", "Score": "0", "Text": "Was this fixed? i have a similar issue.,", "CreationDate": "2019-05-13T02:34:46.887", "UserId": "8292342", "filtered-sentences": []}, {"Id": "112411766", "PostId": "53652549", "Score": "0", "Text": "If you're getting the \"Encountered unsupported property BillingMode\" error, make sure BillingMode is under Properties section only and NOT in other sections such as GlobalSecondaryIndexes. (Unlike ProvisionedThroughput, BillingMode doesn't need to be there.)", "CreationDate": "2020-08-24T23:14:44.827", "UserId": "1262276", "filtered-sentences": []}], "history": [{"Id": "187288425", "PostHistoryTypeId": "2", "PostId": "53652549", "RevisionGUID": "84f21b72-4476-4960-98f0-b7003d16720a", "CreationDate": "2018-12-06T13:29:06.690", "UserId": "8786986", "Text": "I've seen this [site][1] about DynamoDB On-demand and I updated my tables, created by CloudFormation, to On-demand. Now, when I try to update my Stack, I get this error:\r\n\r\n> One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST\r\n\r\nIs there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? \r\n\r\nThank you. \r\n\r\n\r\n  [1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Is there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? ", "keywords": ["billing mode"]}, {"source": "Text", "text": "[1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "keywords": ["pay"]}]}, {"Id": "187288426", "PostHistoryTypeId": "1", "PostId": "53652549", "RevisionGUID": "84f21b72-4476-4960-98f0-b7003d16720a", "CreationDate": "2018-12-06T13:29:06.690", "UserId": "8786986", "Text": "How to set DynamoDB Read/write capacity mode to On-demand on CloudFormation", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "How to set DynamoDB Read/write capacity mode to On-demand on CloudFormation", "keywords": ["billing mode"]}]}, {"Id": "187288427", "PostHistoryTypeId": "3", "PostId": "53652549", "RevisionGUID": "84f21b72-4476-4960-98f0-b7003d16720a", "CreationDate": "2018-12-06T13:29:06.690", "UserId": "8786986", "Text": "|amazon-web-services|amazon-dynamodb|aws-cloudformation|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "187296454", "PostHistoryTypeId": "5", "PostId": "53652549", "RevisionGUID": "6566a036-efd3-4fde-88a3-9e53526fd943", "CreationDate": "2018-12-06T15:21:53.840", "UserId": "8786986", "Comment": "added 442 characters in body", "Text": "I've seen this [site][1] about DynamoDB On-demand and I updated my tables, created by CloudFormation, to On-demand. Now, when I try to update my Stack, I get this error:\r\n\r\n> One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST\r\n\r\nIs there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? \r\n\r\n**EDIT:**\r\n\r\nI've updated to On-demand on AWS Console.\r\n\r\n**EDIT 2:**\r\n\r\nMy template:\r\n\r\n  \r\n\r\n    DynamoDBUsersTable:\r\n        Type: AWS::DynamoDB::Table\r\n        Description: Users table\r\n        Properties:\r\n          TableName: !Sub ${StackName}-users-table\r\n          AttributeDefinitions:\r\n            - AttributeName: userId\r\n              AttributeType: S\r\n          KeySchema:\r\n            - AttributeName: userId\r\n              KeyType: HASH\r\n          ProvisionedThroughput:\r\n            ReadCapacityUnits: 10\r\n            WriteCapacityUnits: 10\r\n\r\nThank you. \r\n\r\n\r\n  [1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Now, when I try to update my Stack, I get this error: > One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST Is there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? **EDIT:** I've updated to On-demand on AWS Console. **EDIT 2:** My template: DynamoDBUsersTable: Type: AWS::DynamoDB::Table Description: Users table Properties: TableName: !Sub ${StackName}-users-table AttributeDefinitions: - AttributeName: userId AttributeType: S KeySchema: - AttributeName: userId KeyType: HASH ProvisionedThroughput: ReadCapacityUnits: 10 WriteCapacityUnits: 10 Thank you. [1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "keywords": ["pay", "billing mode"]}]}, {"Id": "187290950", "PostHistoryTypeId": "5", "PostId": "53652549", "RevisionGUID": "b9590689-1e9e-4267-a3cf-2abedfa69927", "CreationDate": "2018-12-06T14:04:02.717", "UserId": "8786986", "Comment": "added 54 characters in body", "Text": "I've seen this [site][1] about DynamoDB On-demand and I updated my tables, created by CloudFormation, to On-demand. Now, when I try to update my Stack, I get this error:\r\n\r\n> One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST\r\n\r\nIs there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? \r\n\r\n**EDIT:**\r\n\r\nI've updated to On-demand on AWS Console.\r\n\r\nThank you. \r\n\r\n\r\n  [1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Now, when I try to update my Stack, I get this error: > One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST Is there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? **EDIT:** I've updated to On-demand on AWS Console. ", "keywords": ["billing mode"]}, {"source": "Text", "text": "[1]: https://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/", "keywords": ["pay"]}]}], "answers": [{"Id": "53975902", "PostTypeId": "2", "ParentId": "53652549", "CreationDate": "2018-12-30T07:20:36.190", "Score": "62", "Body": "<p>You need to add <code>BillingMode: PAY_PER_REQUEST</code> to properties and remove <code>ProvisionedThroughput</code> both from table properties and from all <code>GlobalSecondaryIndexes</code> if they specified. So finally your template have to look like: </p>\n\n<pre><code>DynamoDBUsersTable:\n    Type: AWS::DynamoDB::Table\n    Description: Users table\n    Properties:\n      TableName: !Sub ${StackName}-users-table\n      BillingMode: PAY_PER_REQUEST\n      AttributeDefinitions:\n        - AttributeName: userId\n          AttributeType: S\n      KeySchema:\n        - AttributeName: userId\n          KeyType: HASH\n</code></pre>\n", "OwnerUserId": "5708266", "LastActivityDate": "2018-12-30T07:20:36.190", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "97140839", "PostId": "53975902", "Score": "10", "Text": "Thanks, Konstantin. Additionally, make sure to delete the provisioned throughput of secondary indexes *without* replacing it with BillingMode, otherwise you will get the error 'Encountered unsupported property BillingMode'.", "CreationDate": "2019-03-16T21:56:14.490", "UserId": "8886593", "filtered-sentences": []}, {"Id": "101979766", "PostId": "53975902", "Score": "0", "Text": "@Konstantin Labun Any idea how can it be done conditionally? So my dev and test env has throughput as 1 but for beta and prod I need it to be PAY_PER_REQUEST, how can I achieve that?", "CreationDate": "2019-09-03T13:05:24.033", "UserId": "3067634", "filtered-sentences": [{"source": "Text", "text": "So my dev and test env has throughput as 1 but for beta and prod I need it to be PAY_PER_REQUEST, how can I achieve that?", "keywords": ["test"]}]}, {"Id": "102315792", "PostId": "53975902", "Score": "2", "Text": "You can do it using cloudformation conditions https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-section-structure.html", "CreationDate": "2019-09-16T07:00:03.613", "UserId": "5708266", "filtered-sentences": []}], "history": [{"Id": "188660385", "PostHistoryTypeId": "2", "PostId": "53975902", "RevisionGUID": "aa99d16f-6598-487a-a9eb-0a4341926f23", "CreationDate": "2018-12-30T07:20:36.190", "UserId": "5708266", "Text": "You need to add `BillingMode: PAY_PER_REQUEST` to properties and remove `ProvisionedThroughput` both from table properties and from all `GlobalSecondaryIndexes` if they specified. So finally your template have to look like: \r\n\r\n    DynamoDBUsersTable:\r\n        Type: AWS::DynamoDB::Table\r\n        Description: Users table\r\n        Properties:\r\n          TableName: !Sub ${StackName}-users-table\r\n          BillingMode: PAY_PER_REQUEST\r\n          AttributeDefinitions:\r\n            - AttributeName: userId\r\n              AttributeType: S\r\n          KeySchema:\r\n            - AttributeName: userId\r\n              KeyType: HASH", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "How to set DynamoDB Read/write capacity mode to On-demand on CloudFormation", "keywords": ["billing mode"]}, {"source": "Body", "text": "Now, when I try to update my Stack, I get this error: One or more parameter values were invalid: Neither ReadCapacityUnits nor WriteCapacityUnits can be specified when BillingMode is PAY_PER_REQUEST Is there a way to set DynamoDB Read/write capacity mode to On-demand on CloudFormation? ", "keywords": ["billing mode"]}]}