{"Id": "40273492", "PostTypeId": "1", "CreationDate": "2016-10-26T23:03:21.810", "Score": "17", "ViewCount": "20859", "Body": "<p>This is driving me mad and no matter what I try I always get the following error when creating the stack:</p>\n\n<pre><code>*The parameter groupName cannot be used with the parameter subnet*\n</code></pre>\n\n<p>I have triple checked security groups, subnets are in the same VPC.  Any advice would be amazing, thanks</p>\n\n<pre><code> {\n    \"AWSTemplateFormatVersion\" : \"2010-09-09\",\n\n  \"Description\" : \"Microsoft SQL 2012 R2 Test Application Stack\",\n\n  \"Parameters\" : {\n    \"pInstanceName\" : {\n        \"Description\" : \"Instance name (up to 15 characters)\",\n        \"Type\" : \"String\",\n        \"MinLength\" : \"1\",\n        \"MaxLength\" : \"15\",\n        \"AllowedPattern\" : \"[a-zA-Z0-9]+\",\n        \"Default\" : \"aws2xxxxxxxxxxx\"\n    },\n    \"pInstanceType\" : {\n        \"Description\" : \"EC2 instance type\",\n        \"Type\" : \"String\",\n        \"AllowedValues\" : [ \"t1.micro\", \"t2.micro\", \"t2.small\", \"t2.medium\", \"m1.small\", \"m1.medium\", \"m1.large\", \"m1.xlarge\", \"m2.xlarge\", \"m2.2xlarge\", \"m2.4xlarge\", \"m3.medium\", \"m3.large\", \"m3.xlarge\", \"m3.2xlarge\", \"m4.large\", \"m4.xlarge\", \"m4.2xlarge\", \"m4.4xlarge\", \"m4.10xlarge\", \"c1.medium\", \"c1.xlarge\", \"c3.large\", \"c3.xlarge\", \"c3.2xlarge\", \"c3.4xlarge\", \"c3.8xlarge\", \"c4.large\", \"c4.xlarge\", \"c4.2xlarge\", \"c4.4xlarge\", \"c4.8xlarge\", \"g2.2xlarge\", \"r3.large\", \"r3.xlarge\", \"r3.2xlarge\", \"r3.4xlarge\", \"r3.8xlarge\", \"i2.xlarge\", \"i2.2xlarge\", \"i2.4xlarge\", \"i2.8xlarge\", \"d2.xlarge\", \"d2.2xlarge\", \"d2.4xlarge\", \"d2.8xlarge\", \"hi1.4xlarge\", \"hs1.8xlarge\", \"cr1.8xlarge\", \"cc2.8xlarge\", \"cg1.4xlarge\"],\n        \"ConstraintDescription\" : \"must be a valid EC2 instance type\",\n        \"Default\" : \"t2.small\"\n    },\n    \"pAmi\" : {\n        \"Description\" : \"AMI required to provision instance\",\n        \"Type\" : \"String\",\n        \"Default\" : \"ami-55084526\"\n    },\n    \"pVolumeSize\" : {\n        \"Description\" : \"Root volume size\",\n        \"Type\" : \"String\",\n        \"Default\" : \"60\"\n    },\n    \"pKeyPairName\" : {\n        \"Description\" : \"Name of key pair to use\",\n        \"Type\" : \"String\",\n        \"Default\" : \"win_keys\"\n    },\n    \"pAz\" : {\n        \"Description\" : \"Availability Zone of instance\",\n        \"Type\" : \"String\",\n        \"AllowedValues\" : [\n            \"eu-west-1b\",\n            \"eu-west-1c\"\n        ],\n        \"Default\" : \"eu-west-1b\"\n    },\n    \"pVpcId\" : {\n        \"Description\" : \"VPC-ID\",\n        \"Type\" : \"AWS::EC2::VPC::Id\",\n        \"Default\" : \"vpc-7xxxx513\"\n    },\n    \"pVpcName\" : {\n        \"Description\" : \"VPC of instance\",\n        \"Type\" : \"String\",\n        \"MinLength\" : \"3\",\n        \"MaxLength\" : \"4\",\n        \"AllowedPattern\" : \"^(aws)\\\\d\",\n        \"Default\" : \"aws\"\n    },\n    \"pEnvironment\" : {\n        \"Description\" : \"Environment\",\n        \"Type\" : \"String\",\n        \"Default\" : \"preProduction\",\n        \"AllowedValues\" : [\n            \"development\",\n            \"test\",\n            \"preProduction\",\n            \"production\"\n        ],\n        \"ConstraintDescription\" : \"specify environment stack\"\n    },\n    \"pSystem\" : {\n        \"Description\" : \"Application or System instance is part of\",\n        \"Type\" : \"String\",\n        \"Default\" : \"n/a\"\n    },\n    \"pDefaultSg\" : {\n        \"Description\" : \"Default VPC Security Groups\",\n        \"Type\" : \"List&lt;AWS::EC2::SecurityGroup::Id&gt;\",\n        \"Default\" : \"sg-24xxxx41,sg-2xxxx342,sg-235bxxxx\" \n    },\n    \"pServerRole\" : {\n        \"Description\" : \"Role of the instance\",\n        \"Type\" : \"String\",\n        \"Default\" : \"n/a\"\n    },\n    \"pOwnerContact\" : {\n        \"Description\" : \"Owner email address responsible for instance\",\n        \"Type\" : \"String\",\n        \"AllowedPattern\" : \"([a-zA-Z0-9]|-|\\\\.)+@([a-zA-Z0-9]|-|\\\\.)+\",\n        \"ConstraintDescription\" : \"Owner email address: email@domain.com\",\n        \"Default\" : \"xxxx@domain.com\"\n    },\n    \"pDepartment\" : {\n        \"Description\" : \"Department responsible for instance \",\n        \"Type\" : \"String\",\n        \"Default\" : \"n/a\"\n    },\n    \"pProjectCode\" : {\n        \"Description\" : \"Project or Cost Centre code\",\n        \"Type\" : \"String\",\n        \"MinLength\" : \"1\",\n        \"MaxLength\" : \"30\",\n        \"Default\" : \"n/a\"\n    },\n    \"pVersion\" : {\n        \"Description\" : \"Version of resource\",\n        \"Type\" : \"String\",\n        \"Default\" : \"n/a\"\n    },\n    \"pCreationDate\" : {\n        \"Description\" : \"Creation date of instance\",\n        \"Type\" : \"String\",\n        \"AllowedPattern\" : \"^\\\\d{4}(-\\\\d{2}){2}\",\n        \"Default\" : \"2016-10-25\"\n    }\n  },    \n  \"Resources\" : {\n    \"sgTestPre\" : {\n        \"Type\" : \"AWS::EC2::SecurityGroup\",\n            \"Properties\" : {\n                \"GroupDescription\" : \"Security Group for Test environments\",\n                \"VpcId\" : { \"Ref\" : \"pVpcId\" },\n                \"SecurityGroupIngress\" : [ {\n                    \"IpProtocol\" : \"tcp\",\n                    \"FromPort\" : \"3389\",\n                    \"ToPort\" : \"3389\",\n                    \"CidrIp\" : \"192.168.0.0/16\"\n                } ]\n            }\n    },\n    \"ec2Instance\" : {\n        \"Type\" : \"AWS::EC2::Instance\",\n        \"Properties\" : {\n            \"ImageId\" : { \"Ref\" : \"pAmi\" },\n            \"InstanceType\" : { \"Ref\" : \"pInstanceType\" },\n            \"KeyName\" : { \"Ref\" : \"pKeyPairName\" },\n            \"SecurityGroupIds\" : [\n                {\"Fn::Join\":\n                    [\",\",\n                        {\"Ref\": \"pDefaultSg\"}\n                    ]\n                },\n                { \"Fn::GetAtt\": [\"sgTestPre\", \"GroupId\"] }\n            ],\n            \"SubnetId\" : \"subnet-3xxxx948\",\n            \"BlockDeviceMappings\" : [ {\n                \"DeviceName\" : \"/dev/sda1\",\n                \"Ebs\" : { \"VolumeSize\" : {\"Ref\": \"pVolumeSize\"} }\n            } ],\n            \"Tags\" : [\n                {\n                    \"Key\" : \"Name\",\n                    \"Value\" : { \"Ref\" : \"pInstanceName\" }\n                },\n                {\n                    \"Key\" : \"Environment\",\n                    \"Value\" : { \"Ref\" : \"pEnvironment\" }\n                },\n                {\n                    \"Key\" : \"System\",\n                    \"Value\" : { \"Ref\" : \"pSystem\" }\n                },\n                {\n                    \"Key\" : \"ServerRole\",\n                    \"Value\" : { \"Ref\" : \"pServerRole\" }\n                },\n                {\n                    \"Key\" : \"OwnerContact\",\n                    \"Value\" : { \"Ref\" : \"pOwnerContact\" }\n                },\n                {\n                    \"Key\" : \"Department\",\n                    \"Value\" : { \"Ref\" : \"pDepartment\" }\n                },\n                {\n                    \"Key\" : \"ProjectCode\",\n                    \"Value\" : { \"Ref\" : \"pProjectCode\" }\n                },\n                {\n                    \"Key\" : \"VpcName\",\n                    \"Value\" : { \"Ref\" : \"pVpcName\" }\n                },\n                {\n                    \"Key\" : \"Version\",\n                    \"Value\" : { \"Ref\" : \"pVersion\" }\n                },\n                {\n                    \"Key\" : \"CreationDate\",\n                    \"Value\" : { \"Ref\" : \"pCreationDate\" }\n                }\n            ]\n        }\n    }\n  },\n  \"Outputs\" : {\n  }\n}\n</code></pre>\n", "OwnerUserId": "7009883", "LastActivityDate": "2024-02-15T02:03:38.213", "Title": "AWS CFN \"The parameter groupName cannot be used with the parameter subnet\"", "Tags": "|amazon-web-services|aws-cloudformation|", "AnswerCount": "5", "CommentCount": "2", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 3.0", "comments": [{"Id": "67820050", "PostId": "40273492", "Score": "0", "Text": "show the whole command you use to run the stack.", "CreationDate": "2016-10-27T09:19:03.583", "UserId": "268668", "filtered-sentences": []}, {"Id": "67823438", "PostId": "40273492", "Score": "0", "Text": "Hi,  the stack is executed from within the AWS Console and defaults accepted.", "CreationDate": "2016-10-27T10:48:13.107", "UserId": "7009883", "filtered-sentences": []}], "history": [{"Id": "130213581", "PostHistoryTypeId": "2", "PostId": "40273492", "RevisionGUID": "bdf50b03-07ae-4d18-a109-ba9d0bd092b3", "CreationDate": "2016-10-26T23:03:21.810", "UserId": "7009883", "Text": "This is driving me mad and no matter what I try I always get the following error when creating the stack:\r\n\r\n *The parameter groupName cannot be used with the parameter subnet*\r\n\r\nI have triple checked security groups, subnets are in the same VPC.  Any advice would be amazing, thanks\r\n\r\n   \r\n\r\n     {\r\n        \"AWSTemplateFormatVersion\" : \"2010-09-09\",\r\n    \r\n      \"Description\" : \"Microsoft SQL 2012 R2 Test Application Stack\",\r\n      \r\n      \"Parameters\" : {\r\n     \"pInstanceName\" : {\r\n      \"Description\" : \"Instance name (up to 15 characters)\",\r\n      \"Type\" : \"String\",\r\n      \"MinLength\" : \"1\",\r\n      \"MaxLength\" : \"15\",\r\n      \"AllowedPattern\" : \"[a-zA-Z0-9]+\",\r\n      \"Default\" : \"aws2xxxxxxxxxxx\"\r\n     },\r\n     \"pInstanceType\" : {\r\n      \"Description\" : \"EC2 instance type\",\r\n      \"Type\" : \"String\",\r\n      \"AllowedValues\" : [ \"t1.micro\", \"t2.micro\", \"t2.small\", \"t2.medium\", \"m1.small\", \"m1.medium\", \"m1.large\", \"m1.xlarge\", \"m2.xlarge\", \"m2.2xlarge\", \"m2.4xlarge\", \"m3.medium\", \"m3.large\", \"m3.xlarge\", \"m3.2xlarge\", \"m4.large\", \"m4.xlarge\", \"m4.2xlarge\", \"m4.4xlarge\", \"m4.10xlarge\", \"c1.medium\", \"c1.xlarge\", \"c3.large\", \"c3.xlarge\", \"c3.2xlarge\", \"c3.4xlarge\", \"c3.8xlarge\", \"c4.large\", \"c4.xlarge\", \"c4.2xlarge\", \"c4.4xlarge\", \"c4.8xlarge\", \"g2.2xlarge\", \"r3.large\", \"r3.xlarge\", \"r3.2xlarge\", \"r3.4xlarge\", \"r3.8xlarge\", \"i2.xlarge\", \"i2.2xlarge\", \"i2.4xlarge\", \"i2.8xlarge\", \"d2.xlarge\", \"d2.2xlarge\", \"d2.4xlarge\", \"d2.8xlarge\", \"hi1.4xlarge\", \"hs1.8xlarge\", \"cr1.8xlarge\", \"cc2.8xlarge\", \"cg1.4xlarge\"],\r\n      \"ConstraintDescription\" : \"must be a valid EC2 instance type\",\r\n      \"Default\" : \"t2.small\"\r\n     },\r\n     \"pAmi\" : {\r\n      \"Description\" : \"AMI required to provision instance\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"ami-55084526\"\r\n     },\r\n     \"pVolumeSize\" : {\r\n      \"Description\" : \"Root volume size\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"60\"\r\n     },\r\n     \"pKeyPairName\" : {\r\n      \"Description\" : \"Name of key pair to use\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"win_keys\"\r\n     },\r\n     \"pAz\" : {\r\n      \"Description\" : \"Availability Zone of instance\",\r\n      \"Type\" : \"String\",\r\n      \"AllowedValues\" : [\r\n       \"eu-west-1b\",\r\n       \"eu-west-1c\"\r\n      ],\r\n      \"Default\" : \"eu-west-1b\"\r\n     },\r\n     \"pVpcId\" : {\r\n      \"Description\" : \"VPC-ID\",\r\n      \"Type\" : \"AWS::EC2::VPC::Id\",\r\n      \"Default\" : \"vpc-7xxxx513\"\r\n     },\r\n     \"pVpcName\" : {\r\n      \"Description\" : \"VPC of instance\",\r\n      \"Type\" : \"String\",\r\n      \"MinLength\" : \"3\",\r\n      \"MaxLength\" : \"4\",\r\n      \"AllowedPattern\" : \"^(aws)\\\\d\",\r\n      \"Default\" : \"aws\"\r\n     },\r\n     \"pEnvironment\" : {\r\n      \"Description\" : \"Environment\",\r\n      \"Type\" : \"String\",\r\n        \"Default\" : \"preProduction\",\r\n      \"AllowedValues\" : [\r\n       \"development\",\r\n       \"test\",\r\n       \"preProduction\",\r\n       \"production\"\r\n      ],\r\n        \"ConstraintDescription\" : \"specify environment stack\"\r\n     },\r\n     \"pSystem\" : {\r\n      \"Description\" : \"Application or System instance is part of\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"n/a\"\r\n     },\r\n     \"pDefaultSg\" : {\r\n      \"Description\" : \"Default VPC Security Groups\",\r\n      \"Type\" : \"List<AWS::EC2::SecurityGroup::Id>\",\r\n      \"Default\" : \"sg-24xxxx41,sg-2xxxx342,sg-235bxxxx\" \r\n     },\r\n     \"pServerRole\" : {\r\n      \"Description\" : \"Role of the instance\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"n/a\"\r\n     },\r\n     \"pOwnerContact\" : {\r\n      \"Description\" : \"Owner email address responsible for instance\",\r\n      \"Type\" : \"String\",\r\n      \"AllowedPattern\" : \"([a-zA-Z0-9]|-|\\\\.)+@([a-zA-Z0-9]|-|\\\\.)+\",\r\n      \"ConstraintDescription\" : \"Owner email address: email@domain.com\",\r\n      \"Default\" : \"xxxx@domain.com\"\r\n     },\r\n     \"pDepartment\" : {\r\n      \"Description\" : \"Department responsible for instance \",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"n/a\"\r\n     },\r\n     \"pProjectCode\" : {\r\n      \"Description\" : \"Project or Cost Centre code\",\r\n      \"Type\" : \"String\",\r\n      \"MinLength\" : \"1\",\r\n      \"MaxLength\" : \"30\",\r\n      \"Default\" : \"n/a\"\r\n     },\r\n     \"pVersion\" : {\r\n      \"Description\" : \"Version of resource\",\r\n      \"Type\" : \"String\",\r\n      \"Default\" : \"n/a\"\r\n     },\r\n     \"pCreationDate\" : {\r\n      \"Description\" : \"Creation date of instance\",\r\n      \"Type\" : \"String\",\r\n      \"AllowedPattern\" : \"^\\\\d{4}(-\\\\d{2}){2}\",\r\n      \"Default\" : \"2016-10-25\"\r\n     }\r\n      }, \r\n      \"Resources\" : {\r\n     \"sgTestPre\" : {\r\n      \"Type\" : \"AWS::EC2::SecurityGroup\",\r\n       \"Properties\" : {\r\n        \"GroupDescription\" : \"Security Group for Test environments\",\r\n        \"VpcId\" : { \"Ref\" : \"pVpcId\" },\r\n        \"SecurityGroupIngress\" : [ {\r\n         \"IpProtocol\" : \"tcp\",\r\n         \"FromPort\" : \"3389\",\r\n         \"ToPort\" : \"3389\",\r\n         \"CidrIp\" : \"192.168.0.0/16\"\r\n        } ]\r\n       }\r\n     },\r\n     \"ec2Instance\" : {\r\n      \"Type\" : \"AWS::EC2::Instance\",\r\n      \"Properties\" : {\r\n          \"ImageId\" : { \"Ref\" : \"pAmi\" },\r\n            \"InstanceType\" : { \"Ref\" : \"pInstanceType\" },\r\n             \"KeyName\" : { \"Ref\" : \"pKeyPairName\" },\r\n       \"SecurityGroupIds\" : [\r\n        {\"Fn::Join\":\r\n         [\",\",\r\n          {\"Ref\": \"pDefaultSg\"}\r\n         ]\r\n        },\r\n        { \"Fn::GetAtt\": [\"sgTestPre\", \"GroupId\"] }\r\n       ],\r\n       \"SubnetId\" : \"subnet-3xxxx948\",\r\n       \"BlockDeviceMappings\" : [ {\r\n        \"DeviceName\" : \"/dev/sda1\",\r\n        \"Ebs\" : { \"VolumeSize\" : {\"Ref\": \"pVolumeSize\"} }\r\n       } ],\r\n       \"Tags\" : [\r\n        {\r\n         \"Key\" : \"Name\",\r\n         \"Value\" : { \"Ref\" : \"pInstanceName\" }\r\n        },\r\n        {\r\n         \"Key\" : \"Environment\",\r\n         \"Value\" : { \"Ref\" : \"pEnvironment\" }\r\n        },\r\n        {\r\n         \"Key\" : \"System\",\r\n         \"Value\" : { \"Ref\" : \"pSystem\" }\r\n        },\r\n        {\r\n         \"Key\" : \"ServerRole\",\r\n         \"Value\" : { \"Ref\" : \"pServerRole\" }\r\n        },\r\n        {\r\n         \"Key\" : \"OwnerContact\",\r\n         \"Value\" : { \"Ref\" : \"pOwnerContact\" }\r\n        },\r\n        {\r\n         \"Key\" : \"Department\",\r\n         \"Value\" : { \"Ref\" : \"pDepartment\" }\r\n        },\r\n        {\r\n         \"Key\" : \"ProjectCode\",\r\n         \"Value\" : { \"Ref\" : \"pProjectCode\" }\r\n        },\r\n        {\r\n         \"Key\" : \"VpcName\",\r\n         \"Value\" : { \"Ref\" : \"pVpcName\" }\r\n        },\r\n        {\r\n         \"Key\" : \"Version\",\r\n         \"Value\" : { \"Ref\" : \"pVersion\" }\r\n        },\r\n        {\r\n         \"Key\" : \"CreationDate\",\r\n         \"Value\" : { \"Ref\" : \"pCreationDate\" }\r\n        }\r\n       ]\r\n         }\r\n      }\r\n      },\r\n      \"Outputs\" : {\r\n      }\r\n    }\r\n\r\n\r\n\r\n", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "Any advice would be amazing, thanks { \"AWSTemplateFormatVersion\" : \"2010-09-09\", \"Description\" : \"Microsoft SQL 2012 R2 Test Application Stack\", \"Parameters\" : { \"pInstanceName\" : { \"Description\" : \"Instance name (up to 15 characters)\", \"Type\" : \"String\", \"MinLength\" : \"1\", \"MaxLength\" : \"15\", \"AllowedPattern\" : \"[a-zA-Z0-9]+\", \"Default\" : \"aws2xxxxxxxxxxx\" }, \"pInstanceType\" : { \"Description\" : \"EC2 instance type\", \"Type\" : \"String\", \"AllowedValues\" : [ \"t1.micro\", \"t2.micro\", \"t2.small\", \"t2.medium\", \"m1.small\", \"m1.medium\", \"m1.large\", \"m1.xlarge\", \"m2.xlarge\", \"m2.2xlarge\", \"m2.4xlarge\", \"m3.medium\", \"m3.large\", \"m3.xlarge\", \"m3.2xlarge\", \"m4.large\", \"m4.xlarge\", \"m4.2xlarge\", \"m4.4xlarge\", \"m4.10xlarge\", \"c1.medium\", \"c1.xlarge\", \"c3.large\", \"c3.xlarge\", \"c3.2xlarge\", \"c3.4xlarge\", \"c3.8xlarge\", \"c4.large\", \"c4.xlarge\", \"c4.2xlarge\", \"c4.4xlarge\", \"c4.8xlarge\", \"g2.2xlarge\", \"r3.large\", \"r3.xlarge\", \"r3.2xlarge\", \"r3.4xlarge\", \"r3.8xlarge\", \"i2.xlarge\", \"i2.2xlarge\", \"i2.4xlarge\", \"i2.8xlarge\", \"d2.xlarge\", \"d2.2xlarge\", \"d2.4xlarge\", \"d2.8xlarge\", \"hi1.4xlarge\", \"hs1.8xlarge\", \"cr1.8xlarge\", \"cc2.8xlarge\", \"cg1.4xlarge\"], \"ConstraintDescription\" : \"must be a valid EC2 instance type\", \"Default\" : \"t2.small\" }, \"pAmi\" : { \"Description\" : \"AMI required to provision instance\", \"Type\" : \"String\", \"Default\" : \"ami-55084526\" ", "keywords": ["instance", "test"]}, {"source": "Text", "text": "}, \"pAz\" : { \"Description\" : \"Availability Zone of instance\", \"Type\" : \"String\", \"AllowedValues\" : [ \"eu-west-1b\", \"eu-west-1c\" ], \"Default\" : \"eu-west-1b\" ", "keywords": ["instance"]}, {"source": "Text", "text": "}, \"pVpcName\" : { \"Description\" : \"VPC of instance\", \"Type\" : \"String\", \"MinLength\" : \"3\", \"MaxLength\" : \"4\", \"AllowedPattern\" : \"^(aws)\\\\d\", \"Default\" : \"aws\" ", "keywords": ["instance"]}, {"source": "Text", "text": "}, \"pEnvironment\" : { \"Description\" : \"Environment\", \"Type\" : \"String\", \"Default\" : \"preProduction\", \"AllowedValues\" : [ \"development\", \"test\", \"preProduction\", \"production\" ], \"ConstraintDescription\" : \"specify environment stack\" }, \"pSystem\" : { \"Description\" : \"Application or System instance is part of\", \"Type\" : \"String\", \"Default\" : \"n/a\" }, \"pDefaultSg\" : { \"Description\" : \"Default VPC Security Groups\", \"Type\" : \"List\", \"Default\" : \"sg-24xxxx41,sg-2xxxx342,sg-235bxxxx\" }, \"pServerRole\" : { \"Description\" : \"Role of the instance\", \"Type\" : \"String\", \"Default\" : \"n/a\" }, \"pOwnerContact\" : { \"Description\" : \"Owner email address responsible for instance\", \"Type\" : \"String\", \"AllowedPattern\" : \"([a-zA-Z0-9]|-|\\\\.)+@([a-zA-Z0-9]|-|\\\\.)+\", \"ConstraintDescription\" : \"Owner email address: email@domain.com\", \"Default\" : \"xxxx@domain.com\" ", "keywords": ["instance", "domain", "test"]}, {"source": "Text", "text": "}, \"pDepartment\" : { \"Description\" : \"Department responsible for instance \", \"Type\" : \"String\", \"Default\" : \"n/a\" ", "keywords": ["instance"]}, {"source": "Text", "text": "}, \"pProjectCode\" : { \"Description\" : \"Project or Cost Centre code\", \"Type\" : \"String\", \"MinLength\" : \"1\", \"MaxLength\" : \"30\", \"Default\" : \"n/a\" ", "keywords": ["cost"]}, {"source": "Text", "text": "}, \"pCreationDate\" : { \"Description\" : \"Creation date of instance\", \"Type\" : \"String\", \"AllowedPattern\" : \"^\\\\d{4}(-\\\\d{2}){2}\", \"Default\" : \"2016-10-25\" } }, \"Resources\" : { \"sgTestPre\" : { \"Type\" : \"AWS::EC2::SecurityGroup\", \"Properties\" : { \"GroupDescription\" : \"Security Group for Test environments\", \"VpcId\" : { \"Ref\" : \"pVpcId\" ", "keywords": ["instance", "test"]}, {"source": "Text", "text": "}, \"SecurityGroupIngress\" : [ { \"IpProtocol\" : \"tcp\", \"FromPort\" : \"3389\", \"ToPort\" : \"3389\", \"CidrIp\" : \"192.168.0.0/16\" } ] } }, \"ec2Instance\" : { \"Type\" : \"AWS::EC2::Instance\", \"Properties\" : { \"ImageId\" : { \"Ref\" : \"pAmi\" ", "keywords": ["instance"]}]}, {"Id": "130213582", "PostHistoryTypeId": "1", "PostId": "40273492", "RevisionGUID": "bdf50b03-07ae-4d18-a109-ba9d0bd092b3", "CreationDate": "2016-10-26T23:03:21.810", "UserId": "7009883", "Text": "AWS CFN \"The parameter groupName cannot be used with the parameter subnet\"", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "130213583", "PostHistoryTypeId": "3", "PostId": "40273492", "RevisionGUID": "bdf50b03-07ae-4d18-a109-ba9d0bd092b3", "CreationDate": "2016-10-26T23:03:21.810", "UserId": "7009883", "Text": "|amazon-web-services|aws-cloudformation|", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "answers": [{"Id": "77998112", "PostTypeId": "2", "ParentId": "40273492", "CreationDate": "2024-02-15T02:03:38.213", "Score": "0", "Body": "<p><strong>For non default vpcs, pass a list of security group ids instead of group names.\nWe faced the issue suddenly breaking some of our test environments but this minor change turned out to be a quick fix.</strong></p>\n", "OwnerUserId": "5410150", "LastActivityDate": "2024-02-15T02:03:38.213", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "303301508", "PostHistoryTypeId": "2", "PostId": "77998112", "RevisionGUID": "4a16306c-afd4-4b57-902e-32b126f753fc", "CreationDate": "2024-02-15T02:03:38.213", "UserId": "5410150", "Text": "**For non default vpcs, pass a list of security group ids instead of group names. \r\nWe faced the issue suddenly breaking some of our test environments but this minor change turned out to be a quick fix.** ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "We faced the issue suddenly breaking some of our test environments but this minor change turned out to be a quick fix.**", "keywords": ["change", "test"]}]}], "filtered-sentences": [{"source": "Body", "text": "We faced the issue suddenly breaking some of our test environments but this minor change turned out to be a quick fix.", "keywords": ["change", "test"]}]}, {"Id": "43440580", "PostTypeId": "2", "ParentId": "40273492", "CreationDate": "2017-04-16T18:24:39.357", "Score": "13", "Body": "<p>Make sure you are referencing the actual SecurityGroup <strong>IDs</strong> and not the names; use intrinsic function <em>Fn:GetAtt</em> for collecting <strong>all</strong> your ids</p>\n\n<p>{ \"Fn::GetAtt\" : [\"MySecurityGroupResourceName\", \"GroupId\"] } </p>\n\n<p>When you use <em>Ref</em> you are going to get the name if using your default VPC, not the id. From the docs:</p>\n\n<p>\"...When you specify an AWS::EC2::SecurityGroup type as an argument to the Ref function, AWS CloudFormation <strong>returns the security group name</strong> or the security group ID (for EC2-VPC security groups that are not in a default VPC)....\"</p>\n", "OwnerDisplayName": "user6118264", "LastActivityDate": "2017-04-16T18:24:39.357", "CommentCount": "0", "ContentLicense": "CC BY-SA 3.0", "history": [{"Id": "143261116", "PostHistoryTypeId": "2", "PostId": "43440580", "RevisionGUID": "1893ffb2-5b3f-41ee-b620-d4fd8a84700a", "CreationDate": "2017-04-16T18:24:39.357", "UserDisplayName": "user6118264", "Text": "Make sure you are referencing the actual SecurityGroup **IDs** and not the names; use intrinsic function *Fn:GetAtt* for collecting **all** your ids\r\n\r\n{ \"Fn::GetAtt\" : [\"MySecurityGroupResourceName\", \"GroupId\"] } \r\n\r\nWhen you use *Ref* you are going to get the name if using your default VPC, not the id. From the docs:\r\n\r\n\"...When you specify an AWS::EC2::SecurityGroup type as an argument to the Ref function, AWS CloudFormation **returns the security group name** or the security group ID (for EC2-VPC security groups that are not in a default VPC)....\"", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "filtered-sentences": []}, {"Id": "72824907", "PostTypeId": "2", "ParentId": "40273492", "CreationDate": "2022-07-01T05:50:59.480", "Score": "2", "Body": "<p>In my case\nI have created the resource as &quot;SecurityGroups&quot; instead &quot;SecurityGroupIds&quot;,</p>\n<p>so I got the error <em>The parameter groupName cannot be used with the parameter subnet</em></p>\n<p>so validate the resource used in your CFT</p>\n", "OwnerUserId": "11823986", "LastActivityDate": "2022-07-01T05:50:59.480", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "273347710", "PostHistoryTypeId": "2", "PostId": "72824907", "RevisionGUID": "2f2cc13f-109e-47cc-8155-c3e196176463", "CreationDate": "2022-07-01T05:50:59.480", "UserId": "11823986", "Text": "In my case \r\nI have created the resource as \"SecurityGroups\" instead \"SecurityGroupIds\",\r\n\r\nso I got the error *The parameter groupName cannot be used with the parameter subnet*\r\n\r\nso validate the resource used in your CFT", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}, {"Id": "64904015", "PostTypeId": "2", "ParentId": "40273492", "CreationDate": "2020-11-19T01:28:16.423", "Score": "23", "Body": "<p>Although I had a different cause, this same error was given. Google brought me here, so I'll add an answer just in case.</p>\n<p>Unlike your code snippet, I was using <code>SecurityGroups</code> during EC2 instance creation.</p>\n<p>Per <a href=\"https://stackoverflow.com/a/63685857/385273\">this answer</a> and <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-securitygroups\" rel=\"noreferrer\">the docs</a>:</p>\n<blockquote>\n<p><strong>SecurityGroups</strong></p>\n<p>[EC2-Classic, default VPC] The names of the security groups. For a nondefault VPC, you must use security group IDs instead.</p>\n</blockquote>\n<p>So, use <code>SecurityGroupIds</code> instead. You can get that ID, as the other solutions state, with:</p>\n<blockquote>\n<p>{ &quot;Fn::GetAtt&quot; : [&quot;MySecurityGroupResourceName&quot;, &quot;GroupId&quot;] }</p>\n</blockquote>\n<p>So, my final create block looks like:</p>\n<pre><code>&quot;MyEc2Instance&quot;: {\n  &quot;Type&quot;: &quot;AWS::EC2::Instance&quot;,\n  &quot;Properties&quot;: {\n      &quot;AvailabilityZone&quot;: &quot;us-east-1a&quot;,\n      &quot;ImageId&quot;: &quot;ami-04bf6dcdc9ab498ca&quot;,\n      &quot;InstanceType&quot;: &quot;t2.micro&quot;,\n      &quot;KeyName&quot;: { &quot;Ref&quot;: &quot;MyKeyName&quot; },\n      &quot;SecurityGroupIds&quot;: [{ &quot;Fn::GetAtt&quot; : [&quot;MySecurityGroup&quot;, &quot;GroupId&quot;] }],\n      &quot;SourceDestCheck&quot;: false,\n      &quot;SubnetId&quot;: { &quot;Ref&quot;: &quot;MySubnet&quot; }\n    }\n},\n</code></pre>\n", "OwnerUserId": "385273", "LastActivityDate": "2020-11-19T01:28:16.423", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "133978200", "PostId": "64904015", "Score": "1", "Text": "For those who want a YAML example: `SecurityGroupIds: !GetAtt MySecurityGroup.GroupId`", "CreationDate": "2023-04-07T19:59:27.697", "UserId": "1751883", "filtered-sentences": []}], "history": [{"Id": "235206026", "PostHistoryTypeId": "2", "PostId": "64904015", "RevisionGUID": "af6ecaa1-884b-46d9-b641-f5af6a08bad2", "CreationDate": "2020-11-19T01:28:16.423", "UserId": "385273", "Text": "Although I had a different cause, this same error was given. Google brought me here, so I'll add an answer just in case.\r\n\r\nUnlike your code snippet, I was using `SecurityGroups` during EC2 instance creation.\r\n\r\nPer [this answer][1] and [the docs][2]:\r\n\r\n> **SecurityGroups**\r\n>\r\n>[EC2-Classic, default VPC] The names of the security groups. For a nondefault VPC, you must use security group IDs instead.\r\n\r\nSo, use `SecurityGroupIds` instead. You can get that ID, as the other solutions state, with:\r\n\r\n> { \"Fn::GetAtt\" : [\"MySecurityGroupResourceName\", \"GroupId\"] }\r\n\r\nSo, my final create block looks like:\r\n\r\n    \"MyEc2Instance\": {\r\n      \"Type\": \"AWS::EC2::Instance\",\r\n      \"Properties\": {\r\n          \"AvailabilityZone\": \"us-east-1a\",\r\n          \"ImageId\": \"ami-04bf6dcdc9ab498ca\",\r\n          \"InstanceType\": \"t2.micro\",\r\n          \"KeyName\": { \"Ref\": \"MyKeyName\" },\r\n          \"SecurityGroupIds\": [{ \"Fn::GetAtt\" : [\"MySecurityGroup\", \"GroupId\"] }],\r\n          \"SourceDestCheck\": false,\r\n          \"SubnetId\": { \"Ref\": \"MySubnet\" }\r\n        }\r\n    },\r\n\r\n  [1]: https://stackoverflow.com/a/63685857/385273\r\n  [2]: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-securitygroups", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Unlike your code snippet, I was using `SecurityGroups` during EC2 instance creation. ", "keywords": ["instance"]}, {"source": "Text", "text": "You can get that ID, as the other solutions state, with: > { \"Fn::GetAtt\" : [\"MySecurityGroupResourceName\", \"GroupId\"] } So, my final create block looks like: \"MyEc2Instance\": { \"Type\": \"AWS::EC2::Instance\", \"Properties\": { \"AvailabilityZone\": \"us-east-1a\", \"ImageId\": \"ami-04bf6dcdc9ab498ca\", \"InstanceType\": \"t2.micro\", \"KeyName\": { \"Ref\": \"MyKeyName\" }, \"SecurityGroupIds\": [{ \"Fn::GetAtt\" : [\"MySecurityGroup\", \"GroupId\"] }], \"SourceDestCheck\": false, \"SubnetId\": { \"Ref\": \"MySubnet\" } } }, [1]: https://stackoverflow.com/a/63685857/385273 [2]: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-securitygroups", "keywords": ["instance"]}]}], "filtered-sentences": [{"source": "Body", "text": "Unlike your code snippet, I was using SecurityGroups during EC2 instance creation. ", "keywords": ["instance"]}]}, {"Id": "40283829", "PostTypeId": "2", "ParentId": "40273492", "CreationDate": "2016-10-27T11:47:04.663", "Score": "2", "Body": "<p>Below are the modification required in cft to make it work.</p>\n\n<p>Use CommaDelimitedList in parameter section rather than using list for SGs.</p>\n\n<pre><code>\"pDefaultSg\" : {\n    \"Description\" : \"Default VPC Security Groups\",\n    \"Type\": \"CommaDelimitedList\",\n    \"Default\" : \"sg-xxxxx,sg-xxxxx,sg-xxxx\" \n},\n</code></pre>\n\n<p>In Ec2 Instance Creation, use below section to attach sgs.</p>\n\n<pre><code>\"SecurityGroupIds\" : [{ \"Fn::Select\" : [ \"0\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::Select\" : [ \"1\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::Select\" : [ \"2\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::GetAtt\": [\"sgTestPre\", \"GroupId\"] }],\n</code></pre>\n\n<p>Hope this help you.</p>\n", "OwnerUserId": "5877506", "LastActivityDate": "2016-10-27T11:47:04.663", "CommentCount": "0", "ContentLicense": "CC BY-SA 3.0", "history": [{"Id": "130253798", "PostHistoryTypeId": "2", "PostId": "40283829", "RevisionGUID": "30e6072e-d274-419b-9f57-8b9cae09e0e5", "CreationDate": "2016-10-27T11:47:04.663", "UserId": "5877506", "Text": "Below are the modification required in cft to make it work.\r\n\r\nUse CommaDelimitedList in parameter section rather than using list for SGs.\r\n\r\n    \"pDefaultSg\" : {\r\n        \"Description\" : \"Default VPC Security Groups\",\r\n        \"Type\": \"CommaDelimitedList\",\r\n        \"Default\" : \"sg-xxxxx,sg-xxxxx,sg-xxxx\" \r\n    },\r\nIn Ec2 Instance Creation, use below section to attach sgs.\r\n\r\n\r\n    \"SecurityGroupIds\" : [{ \"Fn::Select\" : [ \"0\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::Select\" : [ \"1\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::Select\" : [ \"2\", {\"Ref\" : \"pDefaultSg\"} ] },{ \"Fn::GetAtt\": [\"sgTestPre\", \"GroupId\"] }],\r\n\r\nHope this help you.", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "\"pDefaultSg\" : { \"Description\" : \"Default VPC Security Groups\", \"Type\": \"CommaDelimitedList\", \"Default\" : \"sg-xxxxx,sg-xxxxx,sg-xxxx\" }, In Ec2 Instance Creation, use below section to attach sgs. ", "keywords": ["instance"]}]}], "filtered-sentences": [{"source": "Body", "text": "In Ec2 Instance Creation, use below section to attach sgs. ", "keywords": ["instance"]}]}], "contains-topic": true, "filtered-sentences": []}