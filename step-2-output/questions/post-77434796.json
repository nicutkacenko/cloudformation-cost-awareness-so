{"Id": "77434796", "PostTypeId": "1", "CreationDate": "2023-11-06T23:42:51.693", "Score": "-1", "ViewCount": "95", "Body": "<p>I am getting &quot;Template error: every Fn::GetAtt object requires two non-empty parameters, the resource name and the resource attribute&quot; when my pipeline runs in AWS.\nI am trying to create Output (via Output section) for an S3 web-site URL.</p>\n<p>My CFN script is below.</p>\n<pre><code>Resources:\n  MyS3BucketName:\n  Type: AWS::S3::Bucket\n  Properties:\n    AccessControl: PublicRead\n    WebsiteConfiguration:\n      IndexDocument: index.html\n    BucketName:\n      !Sub\n      - '${TheEnv}-sample-s3-ui-${TheBucketRegion}'\n      - TheEnv: !Ref EnvName\n        TheBucketRegion: !Ref AWS::Region\n    BucketEncryption:\n      ServerSideEncryptionConfiguration:\n        - ServerSideEncryptionByDefault:\n            KMSMasterKeyID: !GetAtt S3BucketKmsKey.Arn\n            SSEAlgorithm: aws:kms\n    PublicAccessBlockConfiguration:\n      BlockPublicAcls: true\n      BlockPublicPolicy: true\n      IgnorePublicAcls: true\n      RestrictPublicBuckets: true\n    LifecycleConfiguration:\n      Rules:\n        - Id: expiration-rule\n          Status: Enabled\n          ExpirationInDays: !Ref S3BucketFileExpirationInDays\n    VersioningConfiguration:\n      Status: Suspended\n\nS3BucketForIncomingFilesBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: !Ref MyS3BucketName\n    PolicyDocument:\n      Statement:\n        - Sid: &quot;FullAccessForOps&quot;\n          Effect: &quot;Allow&quot;\n          Principal:\n            AWS:\n              - !Sub\n                - &quot;arn:aws:iam::${TheAccountNumber}:role/${TheRoleName}&quot;\n                - TheAccountNumber: !FindInMap [AccountNumbers, ops, core]\n                  TheRoleName: &quot;Ops&quot;\n            - !Sub\n              - &quot;arn:aws:iam::${TheAccountNumber}:role/${TheRoleName}&quot;\n              - TheAccountNumber: !FindInMap [AccountNumbers, devops, core]\n                TheRoleName: &quot;Developer&quot;\n        Action:\n          - &quot;s3:*&quot;\n        Resource:\n          - !Join [&quot;&quot;, [&quot;arn:aws:s3:::&quot;, !Ref MyS3BucketName]]\n          - !Join [&quot;&quot;, [&quot;arn:aws:s3:::&quot;, !Ref MyS3BucketName, &quot;/*&quot;]]\n      - Sid: &quot;FullAccessToAccountRoot&quot;\n        Effect: &quot;Allow&quot;\n        Principal:\n          AWS: !Sub 'arn:aws:iam::${AWS::AccountId}:root'\n        Action:\n          - &quot;s3:*&quot;\n        Resource:\n          - !Join [&quot;&quot;, [&quot;arn:aws:s3:::&quot;, !Ref MyS3BucketName]]\n          - !Join [&quot;&quot;, [&quot;arn:aws:s3:::&quot;, !Ref MyS3BucketName, &quot;/*&quot;]]\n\nOutputs:\n  WebsiteURL:\n  Value: !GetAtt MyS3BucketName.Arn\n  Description: URL for website hosted on S3\nS3BucketSecureURL:\n  Value: !Join\n    - ''\n    - - 'https://'\n      - !GetAtt\n      - MyS3BucketName\n      - DomainName\n  Description: Name of S3 bucket to hold website content\n</code></pre>\n<p>I got this example from AWS <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-s3.html\" rel=\"nofollow noreferrer\">page</a></p>\n<p>Not sure what's wrong here.</p>\n<p>Any help is much appreciated.</p>\n", "OwnerUserId": "19299757", "LastActivityDate": "2023-11-07T00:09:55.190", "Title": "Template error for Fn::GetAtt in AWS Cloudformation", "Tags": "|amazon-web-services|amazon-s3|aws-cloudformation|", "AnswerCount": "1", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "136513938", "PostId": "77434796", "Score": "0", "Text": "No, the document on the page you linked is different. Pay attention to the last section (`S3BucketSecureURL.value`) and the indentation. Template in AWS docs passes a 2-element list to `GetAtt`. You pass nothing to `GetAtt` and try to join everything together. Their doc is equivalent to `- !GetAtt: [MyS3BucketName, DomainName]` - it's a long form of `GetAtt` spelling.", "CreationDate": "2023-11-06T23:55:25.600", "UserId": "14401160", "filtered-sentences": [{"source": "Text", "text": "Pay attention to the last section (`S3BucketSecureURL.value`) and the indentation. ", "keywords": ["pay"]}]}], "history": [{"Id": "299858508", "PostHistoryTypeId": "2", "PostId": "77434796", "RevisionGUID": "31b2ab34-47c2-4cdc-a504-571754cb6700", "CreationDate": "2023-11-06T23:42:51.693", "UserId": "19299757", "Text": "I am getting \"Template error: every Fn::GetAtt object requires two non-empty parameters, the resource name and the resource attribute\" when my pipeline runs in AWS.\r\nI am trying to create Output (via Output section) for an S3 web-site URL.\r\n\r\nMy CFN script is below.\r\n\r\n    Resources:\r\n      MyS3BucketName:\r\n      Type: AWS::S3::Bucket\r\n      Properties:\r\n        AccessControl: PublicRead\r\n        WebsiteConfiguration:\r\n          IndexDocument: index.html\r\n        BucketName:\r\n          !Sub\r\n          - '${TheEnv}-sample-s3-ui-${TheBucketRegion}'\r\n          - TheEnv: !Ref EnvName\r\n            TheBucketRegion: !Ref AWS::Region\r\n        BucketEncryption:\r\n          ServerSideEncryptionConfiguration:\r\n            - ServerSideEncryptionByDefault:\r\n                KMSMasterKeyID: !GetAtt S3BucketKmsKey.Arn\r\n                SSEAlgorithm: aws:kms\r\n        PublicAccessBlockConfiguration:\r\n          BlockPublicAcls: true\r\n          BlockPublicPolicy: true\r\n          IgnorePublicAcls: true\r\n          RestrictPublicBuckets: true\r\n        LifecycleConfiguration:\r\n          Rules:\r\n            - Id: expiration-rule\r\n              Status: Enabled\r\n              ExpirationInDays: !Ref S3BucketFileExpirationInDays\r\n        VersioningConfiguration:\r\n          Status: Suspended\r\n\r\n    S3BucketForIncomingFilesBucketPolicy:\r\n      Type: AWS::S3::BucketPolicy\r\n      Properties:\r\n        Bucket: !Ref MyS3BucketName\r\n        PolicyDocument:\r\n          Statement:\r\n            - Sid: \"FullAccessForOps\"\r\n              Effect: \"Allow\"\r\n              Principal:\r\n                AWS:\r\n                  - !Sub\r\n                    - \"arn:aws:iam::${TheAccountNumber}:role/${TheRoleName}\"\r\n                    - TheAccountNumber: !FindInMap [AccountNumbers, ops, core]\r\n                      TheRoleName: \"Ops\"\r\n                - !Sub\r\n                  - \"arn:aws:iam::${TheAccountNumber}:role/${TheRoleName}\"\r\n                  - TheAccountNumber: !FindInMap [AccountNumbers, devops, core]\r\n                    TheRoleName: \"Developer\"\r\n            Action:\r\n              - \"s3:*\"\r\n            Resource:\r\n              - !Join [\"\", [\"arn:aws:s3:::\", !Ref MyS3BucketName]]\r\n              - !Join [\"\", [\"arn:aws:s3:::\", !Ref MyS3BucketName, \"/*\"]]\r\n          - Sid: \"FullAccessToAccountRoot\"\r\n            Effect: \"Allow\"\r\n            Principal:\r\n              AWS: !Sub 'arn:aws:iam::${AWS::AccountId}:root'\r\n            Action:\r\n              - \"s3:*\"\r\n            Resource:\r\n              - !Join [\"\", [\"arn:aws:s3:::\", !Ref MyS3BucketName]]\r\n              - !Join [\"\", [\"arn:aws:s3:::\", !Ref MyS3BucketName, \"/*\"]]\r\n\r\n    Outputs:\r\n      WebsiteURL:\r\n      Value: !GetAtt MyS3BucketName.Arn\r\n      Description: URL for website hosted on S3\r\n    S3BucketSecureURL:\r\n      Value: !Join\r\n        - ''\r\n        - - 'https://'\r\n          - !GetAtt\r\n          - MyS3BucketName\r\n          - DomainName\r\n      Description: Name of S3 bucket to hold website content\r\n\r\n\r\nI got this example from AWS [page](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-s3.html)\r\n\r\nNot sure what's wrong here.\r\n\r\nAny help is much appreciated.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "299858510", "PostHistoryTypeId": "1", "PostId": "77434796", "RevisionGUID": "31b2ab34-47c2-4cdc-a504-571754cb6700", "CreationDate": "2023-11-06T23:42:51.693", "UserId": "19299757", "Text": "Template error for Fn::GetAtt in AWS Cloudformation", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "299858511", "PostHistoryTypeId": "3", "PostId": "77434796", "RevisionGUID": "31b2ab34-47c2-4cdc-a504-571754cb6700", "CreationDate": "2023-11-06T23:42:51.693", "UserId": "19299757", "Text": "|amazon-web-services|amazon-s3|aws-cloudformation|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "77434874", "PostTypeId": "2", "ParentId": "77434796", "CreationDate": "2023-11-07T00:09:55.190", "Score": "0", "Body": "<p>You have to indent your arguments to <code>GetAtt</code>:</p>\n<pre><code>S3BucketSecureURL:\n  Value: !Join\n    - ''\n    - - 'https://'\n      - !GetAtt\n        - MyS3BucketName\n        - DomainName\n</code></pre>\n<p>or</p>\n<pre><code>S3BucketSecureURL:\n  Value: !Join\n    - ''\n    - - 'https://'\n      - !GetAtt MyS3BucketName.DomainName\n</code></pre>\n", "OwnerUserId": "248823", "LastActivityDate": "2023-11-07T00:09:55.190", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "299858982", "PostHistoryTypeId": "2", "PostId": "77434874", "RevisionGUID": "37778671-819f-440d-a658-094ecc441215", "CreationDate": "2023-11-07T00:09:55.190", "UserId": "248823", "Text": "You have to indent your arguments to `GetAtt`:\r\n\r\n```\r\nS3BucketSecureURL:\r\n  Value: !Join\r\n    - ''\r\n    - - 'https://'\r\n      - !GetAtt\r\n        - MyS3BucketName\r\n        - DomainName\r\n```\r\n\r\nor \r\n\r\n\r\n```\r\nS3BucketSecureURL:\r\n  Value: !Join\r\n    - ''\r\n    - - 'https://'\r\n      - !GetAtt MyS3BucketName.DomainName\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": false, "filtered-sentences": []}