{"Id": "69664117", "PostTypeId": "1", "AcceptedAnswerId": "69664399", "CreationDate": "2021-10-21T14:48:14.550", "Score": "0", "ViewCount": "889", "Body": "<p>I need a sample cloud formation template to add spot requests while provisioning the ec2 instance in AWS.I have tried with console to provision spot instances but I couldn't find any exact template for add spot request in ec2</p>\n", "OwnerUserId": "11722419", "LastActivityDate": "2021-10-21T16:44:20.953", "Title": "aws cloudformation template for spot request in ec2 instance", "Tags": "|amazon-web-services|aws-cloudformation|spot-instances|", "AnswerCount": "2", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "256324697", "PostHistoryTypeId": "2", "PostId": "69664117", "RevisionGUID": "1255140d-7c3b-4060-816d-644bc80045ff", "CreationDate": "2021-10-21T14:48:14.550", "UserId": "11722419", "Text": "I need a sample cloud formation template to add spot requests while provisioning the ec2 instance in AWS.I have tried with console to provision spot instances but I couldn't find any exact template for add spot request in ec2", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I need a sample cloud formation template to add spot requests while provisioning the ec2 instance in AWS.", "keywords": ["instance"]}]}, {"Id": "256324699", "PostHistoryTypeId": "1", "PostId": "69664117", "RevisionGUID": "1255140d-7c3b-4060-816d-644bc80045ff", "CreationDate": "2021-10-21T14:48:14.550", "UserId": "11722419", "Text": "aws cloudformation template for spot request in ec2 instance", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "aws cloudformation template for spot request in ec2 instance", "keywords": ["instance"]}]}, {"Id": "256324700", "PostHistoryTypeId": "3", "PostId": "69664117", "RevisionGUID": "1255140d-7c3b-4060-816d-644bc80045ff", "CreationDate": "2021-10-21T14:48:14.550", "UserId": "11722419", "Text": "|amazon-web-services|aws-cloudformation|spot-instances|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "69665802", "PostTypeId": "2", "ParentId": "69664117", "CreationDate": "2021-10-21T16:44:20.953", "Score": "1", "Body": "<p>You need to create Spot-fleet resource.</p>\n<p>Example :</p>\n<pre><code>&quot;SpotFleet&quot;: {\n  &quot;Type&quot;: &quot;AWS::EC2::SpotFleet&quot;,\n  &quot;Properties&quot;: {\n    &quot;SpotFleetRequestConfigData&quot;: {\n     &quot;IamFleetRole&quot;: { &quot;Fn::GetAtt&quot;: [ &quot;IAMFleetRole&quot;, &quot;Arn&quot;] },\n     &quot;SpotPrice&quot;: &quot;1000&quot;,\n     &quot;TargetCapacity&quot;: { &quot;Ref&quot;: &quot;TargetCapacity&quot; },\n     &quot;LaunchSpecifications&quot;: [\n     {\n         &quot;EbsOptimized&quot;: &quot;false&quot;,\n         &quot;InstanceType&quot;: { &quot;Ref&quot;: &quot;InstanceType&quot; },\n         &quot;ImageId&quot;: { &quot;Fn::FindInMap&quot;: [ &quot;AWSRegionArch2AMI&quot;, { &quot;Ref&quot;: &quot;AWS::Region&quot; },\n                      { &quot;Fn::FindInMap&quot;: [ &quot;AWSInstanceType2Arch&quot;, { &quot;Ref&quot;: &quot;InstanceType&quot; }, &quot;Arch&quot; ] }\n                     ]},\n          &quot;SubnetId&quot;: { &quot;Ref&quot;: &quot;Subnet1&quot; },\n          &quot;WeightedCapacity&quot;: &quot;8&quot;\n     },\n     {\n         &quot;EbsOptimized&quot;: &quot;true&quot;,\n         &quot;InstanceType&quot;: { &quot;Ref&quot;: &quot;InstanceType&quot; },\n         &quot;ImageId&quot;: { &quot;Fn::FindInMap&quot;: [ &quot;AWSRegionArch2AMI&quot;, { &quot;Ref&quot;: &quot;AWS::Region&quot; },\n                      { &quot;Fn::FindInMap&quot;: [ &quot;AWSInstanceType2Arch&quot;, { &quot;Ref&quot;: &quot;InstanceType&quot; }, &quot;Arch&quot; ] }\n                     ]},\n          &quot;Monitoring&quot;: { &quot;Enabled&quot;: &quot;true&quot; },\n          &quot;SecurityGroups&quot;: [ { &quot;GroupId&quot;: { &quot;Fn::GetAtt&quot;: [ &quot;SG0&quot;, &quot;GroupId&quot; ] } } ],\n          &quot;SubnetId&quot;: { &quot;Ref&quot;: &quot;Subnet0&quot; },\n          &quot;IamInstanceProfile&quot;: { &quot;Arn&quot;: { &quot;Fn::GetAtt&quot;: [ &quot;RootInstanceProfile&quot;, &quot;Arn&quot; ] } },\n          &quot;WeightedCapacity&quot;: &quot;8&quot;\n         }\n         ]\n     }\n   }\n}\n</code></pre>\n<p>More details can be found in this link :\n<a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-spotfleet.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-spotfleet.html</a></p>\n", "OwnerUserId": "12105019", "LastActivityDate": "2021-10-21T16:44:20.953", "CommentCount": "5", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "123149572", "PostId": "69665802", "Score": "0", "Text": "Thank you ! but in azure we can make spot instance with 3 paramerter like", "CreationDate": "2021-10-22T04:50:59.187", "UserId": "11722419", "filtered-sentences": [{"source": "Text", "text": "but in azure we can make spot instance with 3 paramerter like", "keywords": ["instance"]}]}, {"Id": "123149580", "PostId": "69665802", "Score": "0", "Text": "\"priority\": \"Spot\",\n\"evictionPolicy\": \"Deallocate\",\n\"billingProfile\": {\n    \"maxPrice\": -1\n}https://learn.microsoft.com/en-us/azure/virtual-machines/linux/spot-template same way in aws we can make it?", "CreationDate": "2021-10-22T04:51:36.690", "UserId": "11722419", "filtered-sentences": [{"source": "Text", "text": "\"priority\": \"Spot\", \"evictionPolicy\": \"Deallocate\", \"billingProfile\": { ", "keywords": ["bill"]}]}, {"Id": "123149600", "PostId": "69665802", "Score": "0", "Text": "in aws have ec2 fleet option is there may i know the advantage https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ec2fleet-spotoptionsrequest.html", "CreationDate": "2021-10-22T04:53:41.707", "UserId": "11722419", "filtered-sentences": []}, {"Id": "123150093", "PostId": "69665802", "Score": "0", "Text": "@aryabraj, I guess those 3 are additional properties which can be added. Complete json sample format is given in same link just below those 3 parameters (big one!!).I guess you need that sample format to create spot instances in azure. Moreover, it all depends on cloud platform which you are using. Respective template for cloud platform will differ from other platform.", "CreationDate": "2021-10-22T05:33:55.863", "UserId": "12105019", "filtered-sentences": []}, {"Id": "123179679", "PostId": "69665802", "Score": "0", "Text": "from this request i am getting spot request as fleet, nut i need to create spot instance means spot request type as instance, through console we can enable spot request type while provision a instance, same way have any parameter available in  cloudformation template", "CreationDate": "2021-10-23T13:35:49.503", "UserId": "11722419", "filtered-sentences": [{"source": "Text", "text": "from this request i am getting spot request as fleet, nut i need to create spot instance means spot request type as instance, through console we can enable spot request type while provision a instance, same way have any parameter available in cloudformation template", "keywords": ["instance"]}]}], "history": [{"Id": "256333659", "PostHistoryTypeId": "2", "PostId": "69665802", "RevisionGUID": "deaf7f14-e76e-4694-94b3-a82a52e1b7a9", "CreationDate": "2021-10-21T16:44:20.953", "UserId": "12105019", "Text": "You need to create Spot-fleet resource.\r\n\r\nExample :\r\n\r\n```\r\n\"SpotFleet\": {\r\n  \"Type\": \"AWS::EC2::SpotFleet\",\r\n  \"Properties\": {\r\n    \"SpotFleetRequestConfigData\": {\r\n     \"IamFleetRole\": { \"Fn::GetAtt\": [ \"IAMFleetRole\", \"Arn\"] },\r\n     \"SpotPrice\": \"1000\",\r\n     \"TargetCapacity\": { \"Ref\": \"TargetCapacity\" },\r\n     \"LaunchSpecifications\": [\r\n     {\r\n         \"EbsOptimized\": \"false\",\r\n         \"InstanceType\": { \"Ref\": \"InstanceType\" },\r\n         \"ImageId\": { \"Fn::FindInMap\": [ \"AWSRegionArch2AMI\", { \"Ref\": \"AWS::Region\" },\r\n                      { \"Fn::FindInMap\": [ \"AWSInstanceType2Arch\", { \"Ref\": \"InstanceType\" }, \"Arch\" ] }\r\n                     ]},\r\n          \"SubnetId\": { \"Ref\": \"Subnet1\" },\r\n          \"WeightedCapacity\": \"8\"\r\n     },\r\n     {\r\n         \"EbsOptimized\": \"true\",\r\n         \"InstanceType\": { \"Ref\": \"InstanceType\" },\r\n         \"ImageId\": { \"Fn::FindInMap\": [ \"AWSRegionArch2AMI\", { \"Ref\": \"AWS::Region\" },\r\n                      { \"Fn::FindInMap\": [ \"AWSInstanceType2Arch\", { \"Ref\": \"InstanceType\" }, \"Arch\" ] }\r\n                     ]},\r\n          \"Monitoring\": { \"Enabled\": \"true\" },\r\n          \"SecurityGroups\": [ { \"GroupId\": { \"Fn::GetAtt\": [ \"SG0\", \"GroupId\" ] } } ],\r\n          \"SubnetId\": { \"Ref\": \"Subnet0\" },\r\n          \"IamInstanceProfile\": { \"Arn\": { \"Fn::GetAtt\": [ \"RootInstanceProfile\", \"Arn\" ] } },\r\n          \"WeightedCapacity\": \"8\"\r\n         }\r\n         ]\r\n     }\r\n   }\r\n}\r\n```\r\n\r\nMore details can be found in this link :\r\nhttps://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-spotfleet.html", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}, {"Id": "69664399", "PostTypeId": "2", "ParentId": "69664117", "CreationDate": "2021-10-21T15:05:32.983", "Score": "1", "Body": "<p>You Can create a SpotFleet resource, here's an example</p>\n<pre><code>SpotFleet:\n Type: AWS::EC2::SpotFleet\n Properties:\n   SpotFleetRequestConfigData:\n     IamFleetRole: !GetAtt [IAMFleetRole, Arn]\n     SpotPrice: '1000'\n     TargetCapacity:\n       Ref: TargetCapacity\n     LaunchSpecifications:\n     - EbsOptimized: 'false'\n       InstanceType:\n         Ref: InstanceType\n     ImageId:\n       Fn::FindInMap:\n       - AWSRegionArch2AMI\n       - Ref: AWS::Region\n       - Fn::FindInMap:\n         - AWSInstanceType2Arch\n         - Ref: InstanceType\n         - Arch\n     SubnetId:\n       Ref: Subnet1\n     WeightedCapacity: '8'\n   - EbsOptimized: 'true'\n     InstanceType:\n       Ref: InstanceType\n     ImageId:\n       Fn::FindInMap:\n       - AWSRegionArch2AMI\n       - Ref: AWS::Region\n       - Fn::FindInMap:\n       - AWSInstanceType2Arch\n       - Ref: InstanceType\n       - Arch\n     Monitoring:\n       Enabled: 'true'\n       SecurityGroups:\n        - GroupId:\n            Fn::GetAtt:\n            - SG0\n            - GroupId\n      SubnetId:\n         Ref: Subnet0\n      IamInstanceProfile:\n        Arn:\n        Fn::GetAtt:\n        - RootInstanceProfile\n        - Arn\n      WeightedCapacity: '8'\n</code></pre>\n", "OwnerUserId": "6865225", "LastActivityDate": "2021-10-21T15:05:32.983", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "256326167", "PostHistoryTypeId": "2", "PostId": "69664399", "RevisionGUID": "3eb872eb-b073-432f-a804-1cd5dee26f50", "CreationDate": "2021-10-21T15:05:32.983", "UserId": "6865225", "Text": "You Can create a SpotFleet resource, here's an example \r\n ```\r\nSpotFleet:\r\n  Type: AWS::EC2::SpotFleet\r\n  Properties:\r\n    SpotFleetRequestConfigData:\r\n      IamFleetRole: !GetAtt [IAMFleetRole, Arn]\r\n      SpotPrice: '1000'\r\n      TargetCapacity:\r\n        Ref: TargetCapacity\r\n      LaunchSpecifications:\r\n      - EbsOptimized: 'false'\r\n        InstanceType:\r\n          Ref: InstanceType\r\n      ImageId:\r\n        Fn::FindInMap:\r\n        - AWSRegionArch2AMI\r\n        - Ref: AWS::Region\r\n        - Fn::FindInMap:\r\n          - AWSInstanceType2Arch\r\n          - Ref: InstanceType\r\n          - Arch\r\n      SubnetId:\r\n        Ref: Subnet1\r\n      WeightedCapacity: '8'\r\n    - EbsOptimized: 'true'\r\n      InstanceType:\r\n        Ref: InstanceType\r\n      ImageId:\r\n        Fn::FindInMap:\r\n        - AWSRegionArch2AMI\r\n        - Ref: AWS::Region\r\n        - Fn::FindInMap:\r\n        - AWSInstanceType2Arch\r\n        - Ref: InstanceType\r\n        - Arch\r\n      Monitoring:\r\n        Enabled: 'true'\r\n        SecurityGroups:\r\n         - GroupId:\r\n             Fn::GetAtt:\r\n             - SG0\r\n             - GroupId\r\n       SubnetId:\r\n          Ref: Subnet0\r\n       IamInstanceProfile:\r\n         Arn:\r\n         Fn::GetAtt:\r\n         - RootInstanceProfile\r\n         - Arn\r\n       WeightedCapacity: '8'\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "aws cloudformation template for spot request in ec2 instance", "keywords": ["instance"]}, {"source": "Body", "text": "I need a sample cloud formation template to add spot requests while provisioning the ec2 instance in AWS.", "keywords": ["instance"]}]}