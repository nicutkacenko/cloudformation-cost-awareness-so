{"Id": "68237770", "PostTypeId": "1", "AcceptedAnswerId": "68248958", "CreationDate": "2021-07-03T15:47:43.053", "Score": "2", "ViewCount": "762", "Body": "<p>Trying to create a CFT for RDS which can handle both the scenarios\ncreating a new RDS Aurora MySQL cluster and\ncreate a RDS cluster with a existing DB Cluster Snapshot</p>\n<p>Here is what I tried,</p>\n<p>I have provide the below conditions section of the template</p>\n<pre><code>&quot;UseDbSnapshot&quot; : {\n              &quot;Fn::Not&quot; : [\n                  {\n                      &quot;Fn::Equals&quot;:[\n                            {&quot;Ref&quot;: &quot;DBSnapshotName&quot;},\n                            &quot;&quot;\n                        ]\n                    }\n                ]\n            }\n</code></pre>\n<p>and referenced in Resource section as below</p>\n<pre><code>&quot;RDSCluster1&quot;: {\n        &quot;Type&quot;: &quot;AWS::RDS::DBCluster&quot;,\n        &quot;Condition&quot;: &quot;isResourceCreate&quot;,\n        &quot;Properties&quot;: {\n            &quot;Engine&quot;: &quot;aurora&quot;,\n            &quot;DBSubnetGroupName&quot;: {\n                &quot;Ref&quot;: &quot;DBSubnetGroup&quot;\n            },\n            &quot;DBClusterParameterGroupName&quot;: {\n                &quot;Ref&quot;: &quot;RDSDBClusterParameterGroup&quot;\n            },\n            &quot;DBSnapshotIdentifier&quot; : {\n                &quot;Fn::If&quot; : [\n                  &quot;UseDBSnapshot&quot;,\n                  {&quot;Ref&quot; : &quot;DBSnapshotName&quot;},\n                  {&quot;Ref&quot; : &quot;AWS::NoValue&quot;}\n                ]\n              },\n            &quot;MasterUsername&quot;: {\n                &quot;Ref&quot;: &quot;DbUser&quot;\n            },\n            &quot;MasterUserPassword&quot;: {\n                &quot;Ref&quot;: &quot;MasterUserPassword&quot;\n            },\n            &quot;StorageEncrypted&quot; : true,\n            &quot;KmsKeyId&quot; : {\n                &quot;Ref&quot;: &quot;KmsKeyId&quot;\n            },\n            &quot;VpcSecurityGroupIds&quot;: [\n                {\n                    &quot;Fn::GetAtt&quot;: [\n                        &quot;DBAccessSecurityGroup&quot;,\n                        &quot;GroupId&quot;\n                    ]\n                }\n            ],\n            &quot;Port&quot;: &quot;3306&quot;,\n            &quot;BackupRetentionPeriod&quot;: &quot;1&quot;\n        },\n        &quot;DeletionPolicy&quot;: &quot;Snapshot&quot;\n    }\n</code></pre>\n<p>The condition &quot;isResourceCreate&quot; is satisfied but I am getting below error</p>\n<p>Template error: unresolved condition dependency UseDBSnapshot in Fn::If</p>\n<p>Could you please help me here.</p>\n<p>Have looked up online link <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html</a>\nand created this CFT.</p>\n<p>Let me know if you require any more details.</p>\n", "OwnerUserId": "5648234", "LastEditorUserId": "5648234", "LastEditDate": "2021-07-05T12:44:35.053", "LastActivityDate": "2021-07-05T12:44:35.053", "Title": "CFT Template error: unresolved condition dependency UseDBSnapshot in Fn::If", "Tags": "|json|amazon-web-services|aws-cloudformation|amazon-rds|", "AnswerCount": "1", "CommentCount": "4", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "120605775", "PostId": "68237770", "Score": "1", "Text": "Can you provide complete template? Your current one does not even show paramters.", "CreationDate": "2021-07-03T22:57:38.510", "UserId": "248823", "filtered-sentences": []}, {"Id": "120610159", "PostId": "68237770", "Score": "1", "Text": "You have a typo. UseDbSnapshot != UseDBSnapshot", "CreationDate": "2021-07-04T08:38:43.007", "UserId": "11305581", "filtered-sentences": []}, {"Id": "120614797", "PostId": "68237770", "Score": "0", "Text": "updated my CFT stack code here", "CreationDate": "2021-07-04T14:39:06.673", "UserId": "5648234", "filtered-sentences": []}, {"Id": "120614953", "PostId": "68237770", "Score": "0", "Text": "now, I have the below error after correcting the template Both SnapshotIdentifier and MasterUsername cannot be specified even though I have used `\"Fn::If\" : [     \"UseDbSnapshot\",      {\"Ref\" : \"DBSnapshotName\"},      {\"Ref\" : \"AWS::NoValue\"} ] ` @OleksiiDonoha", "CreationDate": "2021-07-04T14:48:17.400", "UserId": "5648234", "filtered-sentences": []}], "history": [{"Id": "249610693", "PostHistoryTypeId": "2", "PostId": "68237770", "RevisionGUID": "c2b5374d-2039-4876-b732-584ec863b982", "CreationDate": "2021-07-03T15:47:43.053", "UserId": "5648234", "Text": "Trying to create a CFT for RDS which can handle both the scenarios \r\ncreating a new RDS Aurora MySQL cluster and \r\ncreate a RDS cluster with a existing DB Cluster Snapshot \r\n\r\nHere is what I tried,\r\n\r\nI have provide the below conditions section of the template\r\n\r\n    \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n\r\nand referenced in Resource section as below\r\n\r\n    \"RDSCluster1\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"DBSnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDBSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n     ]\r\n      },\r\n    \"MasterUsername\": {\r\n     \"Ref\": \"DbUser\"\r\n    },\r\n    \"MasterUserPassword\": {\r\n     \"Ref\": \"MasterUserPassword\"\r\n    },\r\n    \"StorageEncrypted\" : true,\r\n    \"KmsKeyId\" : {\r\n     \"Ref\": \"KmsKeyId\"\r\n    },\r\n    \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n   },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  }\r\n\r\n\r\nThe condition \"isResourceCreate\" is satisfied but I am getting below error \r\n\r\nTemplate error: unresolved condition dependency UseDBSnapshot in Fn::If\r\n\r\nCould you please help me here.\r\n\r\nHave looked up online link https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html \r\nand created this CFT.\r\n\r\nLet me know if you require any more details.\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Trying to create a CFT for RDS which can handle both the scenarios creating a new RDS Aurora MySQL cluster and create a RDS cluster with a existing DB Cluster Snapshot ", "keywords": ["cluster"]}]}, {"Id": "249610694", "PostHistoryTypeId": "1", "PostId": "68237770", "RevisionGUID": "c2b5374d-2039-4876-b732-584ec863b982", "CreationDate": "2021-07-03T15:47:43.053", "UserId": "5648234", "Text": "CFT Template error: unresolved condition dependency UseDBSnapshot in Fn::If", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "249610695", "PostHistoryTypeId": "3", "PostId": "68237770", "RevisionGUID": "c2b5374d-2039-4876-b732-584ec863b982", "CreationDate": "2021-07-03T15:47:43.053", "UserId": "5648234", "Text": "|json|amazon-web-services|aws-cloudformation|amazon-rds|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "249645105", "PostHistoryTypeId": "5", "PostId": "68237770", "RevisionGUID": "e089cc62-476f-4797-a706-b576f0134987", "CreationDate": "2021-07-04T14:38:49.753", "UserId": "5648234", "Comment": "updated my CFT for RDS cluster creation", "Text": "Trying to create a CFT for RDS which can handle both the scenarios \r\ncreating a new RDS Aurora MySQL cluster and \r\ncreate a RDS cluster with a existing DB Cluster Snapshot \r\n\r\nHere is what I tried,\r\n\r\nI have provide the below conditions section of the template\r\n\r\n    \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n\r\nand referenced in Resource section as below\r\n\r\n    \"RDSCluster1\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"DBSnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDBSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n     ]\r\n      },\r\n    \"MasterUsername\": {\r\n     \"Ref\": \"DbUser\"\r\n    },\r\n    \"MasterUserPassword\": {\r\n     \"Ref\": \"MasterUserPassword\"\r\n    },\r\n    \"StorageEncrypted\" : true,\r\n    \"KmsKeyId\" : {\r\n     \"Ref\": \"KmsKeyId\"\r\n    },\r\n    \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n   },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  }\r\n\r\n\r\nThe condition \"isResourceCreate\" is satisfied but I am getting below error \r\n\r\nTemplate error: unresolved condition dependency UseDBSnapshot in Fn::If\r\n\r\nCould you please help me here.\r\n\r\nHave looked up online link https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html \r\nand created this CFT.\r\n\r\nLet me know if you require any more details.\r\n\r\n\r\n```json\r\n{\r\n \"AWSTemplateFormatVersion\": \"2010-09-09\",\r\n \"Description\": \"This template creates RDS and Elasticsearch resources for Development Environment\",\r\n \"Parameters\": {\r\n  \"Application\": {\r\n   \"Description\": \"Mention the Application Name\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"xyz\"\r\n  },\r\n  \"BusinessName\": {\r\n   \"Description\": \"Mention the business stream name e.g BMSB etc\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"xyzbusiness\"\r\n  },\r\n  \"EnvironmentName\": {\r\n   \"Description\": \"Environment Name like Development or Testing or Production\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"Development\",\r\n   \"AllowedValues\": [\r\n    \"Development\",\r\n    \"Staging\",\r\n    \"Pre-Prod\",\r\n    \"Production\"\r\n   ]\r\n  },\r\n  \"EnvironmentNumber\": {\r\n   \"Description\": \"Environment number like PRO01 or DEV01 or PRE01 etc.\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"DEV01\"\r\n  },\r\n  \"VpcId\": {\r\n   \"Description\": \"Enter the VPC identifier. e.g vpc-xxxxxx\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"vpc-25a5564e\" \r\n  },\r\n  \"DatabaseSubnetA\": {\r\n   \"Description\": \"Specify the subnet created for DB in Availability Zone a\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"subnet-838e97eb\"\r\n  },\r\n  \"DatabaseSubnetB\": {\r\n   \"Description\": \"Specify the subnet created for DB in Availability Zone b\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"subnet-809404fb\"\r\n  },\r\n  \"DBSnapshotName\": {\r\n   \"Description\": \"Specify the DB snapshot identifier  using which this DB has to be created\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"\"\r\n  },\r\n  \"DbAllocatedStorage\": {\r\n   \"Description\": \"The size of the database in GB\",\r\n   \"Type\": \"Number\",\r\n   \"Default\": \"100\"\r\n  },\r\n  \"DbInstanceClass\": {\r\n   \"Description\": \"Database instance class\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"db.t2.small\"\r\n  },\r\n  \"LowFreeStorageThreshold\": {\r\n   \"Description\": \"Enter in BYTES. When available storage on RDS Instancecrosses this limit it will send an alert to Support Team\",\r\n   \"Type\": \"Number\",\r\n   \"Default\": \"10000000000\"\r\n  },\r\n  \"DbUser\": {\r\n   \"Description\": \"Enter the database user name\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"DBUser\"\r\n  },\r\n  \"MasterUserPassword\": {\r\n   \"Description\": \"Enter DB password. Min length is 8. Alphnumeric only. DO NOT USE SPECIAL SYMBOLS\",\r\n   \"NoEcho\": \"true\",\r\n   \"Type\": \"String\",\r\n   \"MinLength\": \"8\",\r\n   \"MaxLength\": \"41\",\r\n   \"AllowedPattern\": \"[a-zA-Z0-9$]*\",\r\n   \"Default\": \"xxxxxxxxxx\"\r\n  },\r\n  \"StorageEnc\": {\r\n   \"Description\": \"Encrypt RDS with KMS CMK say true or false\",\r\n   \"Type\": \"String\",\r\n   \"AllowedValues\": [\r\n    \"True\",\r\n    \"False\"\r\n   ]\r\n  },\r\n  \"KmsKeyId\": {\r\n   \"Description\" : \"Enter the KMS key arn to encrypt RDS instance\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"arn:aws:kms:region:accID:key/xyzkeyid\"\r\n  },\r\n  \"TopicForEmailAlerts\": {\r\n   \"Description\": \"Enter the topic arn that will be used to send alerts\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"arn:aws:sns:region:accID:xyzTopic\"\r\n  },\r\n  \"StackResourceAction\": {\r\n   \"Description\": \"Please choose DELETE if you just want to drop the resources to save cost, otherwise choose Create\",\r\n   \"Type\": \"String\",\r\n   \"AllowedValues\": [\r\n    \"Create/Update\",\r\n    \"Delete\"\r\n   ],\r\n   \"Default\": \"Create/Update\"\r\n  }\r\n },\r\n \"Conditions\": {\r\n  \"isResourceCreate\": {\r\n   \"Fn::Equals\": [\r\n    {\r\n     \"Ref\": \"StackResourceAction\"\r\n    },\r\n    \"Create/Update\"\r\n   ]\r\n  },\r\n  \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n },\r\n \"Resources\": {\r\n  \"DBSubnetGroup\": {\r\n   \"Type\": \"AWS::RDS::DBSubnetGroup\",\r\n   \"Properties\": {\r\n    \"DBSubnetGroupDescription\": \"DB Subnet Group to hold the RDS instances\",\r\n    \"SubnetIds\": [\r\n     {\r\n      \"Ref\": \"DatabaseSubnetA\"\r\n     },\r\n     {\r\n      \"Ref\": \"DatabaseSubnetB\"\r\n     }\r\n    ],\r\n    \"Tags\": [\r\n     {\r\n      \"Key\": \"Name\",\r\n      \"Value\": \"DatabaseSubnetGroup\"\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentName\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentName\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentNumber\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentNumber\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"BusinessName\",\r\n      \"Value\": {\r\n       \"Ref\": \"BusinessName\"\r\n      }\r\n     }\r\n    ]\r\n   }\r\n  },\r\n  \"DBAccessSecurityGroup\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroup\",\r\n   \"Properties\": {\r\n    \"GroupDescription\": \"This security group allows web layer to access its DB layer.\",\r\n    \"VpcId\": {\r\n     \"Ref\": \"VpcId\"\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress1\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"3306\",\r\n    \"ToPort\": \"3306\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress2\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"icmp\",\r\n    \"FromPort\": \"-1\",\r\n    \"ToPort\": \"-1\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress3\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"443\",\r\n    \"ToPort\": \"443\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress4\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"80\",\r\n    \"ToPort\": \"80\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"RDSDBClusterParameterGroup\": {\r\n   \"Type\": \"AWS::RDS::DBClusterParameterGroup\",\r\n   \"Properties\": {\r\n    \"Description\": \"CloudFormation Sample Aurora Cluster Parameter Group\",\r\n    \"Family\": \"aurora5.6\",\r\n    \"Parameters\": {\r\n     \"time_zone\": \"Asia/Calcutta\"\r\n    }\r\n   }\r\n  },\r\n  \"RDSCluster\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"SnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDbSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n      ]\r\n      },\r\n    \"MasterUsername\": {\"Ref\": \"DbUser\"},\r\n    \"MasterUserPassword\": {\"Ref\": \"MasterUserPassword\"},\r\n    \"StorageEncrypted\" : {\"Ref\": \"StorageEnc\"},\r\n    \"KmsKeyId\" : {\"Ref\": \"KmsKeyId\"},\r\n                \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n    },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  },\r\n  \"RDSDBParameterGroup\": {\r\n   \"Type\": \"AWS::RDS::DBParameterGroup\",\r\n   \"Properties\": {\r\n    \"Description\": \"CloudFormation Sample Aurora Parameter Group\",\r\n    \"Family\": \"aurora5.6\",\r\n    \"Parameters\": {\r\n     \"sql_mode\": \"IGNORE_SPACE\"\r\n    }\r\n   }\r\n  },\r\n  \"DbInstance\": {\r\n   \"Type\": \"AWS::RDS::DBInstance\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBParameterGroupName\": {\r\n     \"Ref\": \"RDSDBParameterGroup\"\r\n    },\r\n    \"Engine\": \"aurora\",\r\n    \"DBClusterIdentifier\": {\r\n     \"Ref\": \"RDSCluster\"\r\n    },\r\n    \"PubliclyAccessible\": true,\r\n    \"DBInstanceClass\": {\r\n     \"Ref\": \"DbInstanceClass\"\r\n    },\r\n    \"CopyTagsToSnapshot\": true,\r\n    \"Tags\": [\r\n     {\r\n      \"Key\": \"EnvironmentName\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentName\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentNumber\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentNumber\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"ApplicationName\",\r\n      \"Value\": {\r\n       \"Ref\": \"Application\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"BusinessOwner\",\r\n      \"Value\": \"Xyzowner\"\r\n     },\r\n     {\r\n      \"Key\": \"ApplicationOwner\",\r\n      \"Value\": \"AppOwner\"\r\n     },\r\n     {\r\n      \"Key\": \"AdminOwner\",\r\n      \"Value\": \"AdminOwner\"\r\n     }\r\n    ]\r\n   }\r\n  }\r\n },\r\n \"Outputs\": {\r\n  \"DBHost\": {\r\n   \"Description\": \"DB Instance End Point \",\r\n   \"Value\": {\r\n    \"Fn::GetAtt\": [\r\n     \"DbInstance\",\r\n     \"Endpoint.Address\"\r\n    ]\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBHost\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"Environment\": {\r\n   \"Description\": \"Environment Name \",\r\n   \"Value\": {\r\n    \"Ref\": \"EnvironmentName\"\r\n   }\r\n  },\r\n  \"DBLayerAccessGroupID\": {\r\n   \"Description\": \"DB Access Security Group Name \",\r\n   \"Value\": {\r\n    \"Fn::GetAtt\": [\r\n     \"DBAccessSecurityGroup\",\r\n     \"GroupId\"\r\n    ]\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBLayerAccessGroupID\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"DBHostUserId\": {\r\n   \"Description\": \"User ID of the database for the user. \",\r\n   \"Value\": {\r\n    \"Ref\": \"DbUser\"\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBUserID\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  }\r\n }\r\n}\r\n```\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Trying to create a CFT for RDS which can handle both the scenarios creating a new RDS Aurora MySQL cluster and create a RDS cluster with a existing DB Cluster Snapshot ", "keywords": ["cluster"]}, {"source": "Text", "text": "```json { \"AWSTemplateFormatVersion\": \"2010-09-09\", \"Description\": \"This template creates RDS and Elasticsearch resources for Development Environment\", \"Parameters\": { \"Application\": { \"Description\": \"Mention the Application Name\", \"Type\": \"String\", \"Default\": \"xyz\" }, \"BusinessName\": { \"Description\": \"Mention the business stream name e.g BMSB etc\", \"Type\": \"String\", \"Default\": \"xyzbusiness\" }, \"EnvironmentName\": { \"Description\": \"Environment Name like Development or Testing or Production\", \"Type\": \"String\", \"Default\": \"Development\", \"AllowedValues\": [ \"Development\", \"Staging\", \"Pre-Prod\", \"Production\" ] }, \"EnvironmentNumber\": { \"Description\": \"Environment number like PRO01 or DEV01 or PRE01 etc.\", \"Type\": \"String\", \"Default\": \"DEV01\" }, \"VpcId\": { \"Description\": \"Enter the VPC identifier. e.g vpc-xxxxxx\", \"Type\": \"String\", \"Default\": \"vpc-25a5564e\" }, \"DatabaseSubnetA\": { \"Description\": \"Specify the subnet created for DB in Availability Zone a\", \"Type\": \"String\", \"Default\": \"subnet-838e97eb\" }, \"DatabaseSubnetB\": { \"Description\": \"Specify the subnet created for DB in Availability Zone b\", \"Type\": \"String\", \"Default\": \"subnet-809404fb\" }, \"DBSnapshotName\": { \"Description\": \"Specify the DB snapshot identifier using which this DB has to be created\", \"Type\": \"String\", \"Default\": \"\" }, \"DbAllocatedStorage\": { \"Description\": \"The size of the database in GB\", \"Type\": \"Number\", \"Default\": \"100\" }, \"DbInstanceClass\": { \"Description\": \"Database instance class\", \"Type\": \"String\", \"Default\": \"db.t2.small\" }, \"LowFreeStorageThreshold\": { \"Description\": \"Enter in BYTES. ", "keywords": ["instance", "test"]}, {"source": "Text", "text": "When available storage on RDS Instancecrosses this limit it will send an alert to Support Team\", \"Type\": \"Number\", \"Default\": \"10000000000\" }, \"DbUser\": { \"Description\": \"Enter the database user name\", \"Type\": \"String\", \"Default\": \"DBUser\" }, \"MasterUserPassword\": { \"Description\": \"Enter DB password. ", "keywords": ["storage"]}, {"source": "Text", "text": "Min length is 8. Alphnumeric only. DO NOT USE SPECIAL SYMBOLS\", \"NoEcho\": \"true\", \"Type\": \"String\", \"MinLength\": \"8\", \"MaxLength\": \"41\", \"AllowedPattern\": \"[a-zA-Z0-9$]*\", \"Default\": \"xxxxxxxxxx\" }, \"StorageEnc\": { \"Description\": \"Encrypt RDS with KMS CMK say true or false\", \"Type\": \"String\", \"AllowedValues\": [ \"True\", \"False\" ] }, \"KmsKeyId\": { \"Description\" : \"Enter the KMS key arn to encrypt RDS instance\", \"Type\": \"String\", \"Default\": \"arn:aws:kms:region:accID:key/xyzkeyid\" }, \"TopicForEmailAlerts\": { \"Description\": \"Enter the topic arn that will be used to send alerts\", \"Type\": \"String\", \"Default\": \"arn:aws:sns:region:accID:xyzTopic\" }, \"StackResourceAction\": { \"Description\": \"Please choose DELETE if you just want to drop the resources to save cost, otherwise choose Create\", \"Type\": \"String\", \"AllowedValues\": [ \"Create/Update\", \"Delete\" ], \"Default\": \"Create/Update\" } }, \"Conditions\": { \"isResourceCreate\": { \"Fn::Equals\": [ { \"Ref\": \"StackResourceAction\" }, \"Create/Update\" ] }, \"UseDbSnapshot\" : { \"Fn::Not\" : [ { \"Fn::Equals\":[ {\"Ref\": \"DBSnapshotName\"}, \"\" ] } ] } }, \"Resources\": { \"DBSubnetGroup\": { \"Type\": \"AWS::RDS::DBSubnetGroup\", \"Properties\": { \"DBSubnetGroupDescription\": \"DB Subnet Group to hold the RDS instances\", \"SubnetIds\": [ { \"Ref\": \"DatabaseSubnetA\" }, { \"Ref\": \"DatabaseSubnetB\" } ], \"Tags\": [ { \"Key\": \"Name\", \"Value\": \"DatabaseSubnetGroup\" }, { \"Key\": \"EnvironmentName\", \"Value\": { \"Ref\": \"EnvironmentName\" } }, { \"Key\": \"EnvironmentNumber\", \"Value\": { \"Ref\": \"EnvironmentNumber\" } }, { \"Key\": \"BusinessName\", \"Value\": { \"Ref\": \"BusinessName\" } } ] } }, \"DBAccessSecurityGroup\": { \"Type\": \"AWS::EC2::SecurityGroup\", \"Properties\": { \"GroupDescription\": \"This security group allows web layer to access its DB layer.\", \"VpcId\": { \"Ref\": \"VpcId\" } } }, \"SGBaseIngress1\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"3306\", \"ToPort\": \"3306\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress2\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"icmp\", \"FromPort\": \"-1\", \"ToPort\": \"-1\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress3\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"443\", \"ToPort\": \"443\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress4\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"80\", \"ToPort\": \"80\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"RDSDBClusterParameterGroup\": { \"Type\": \"AWS::RDS::DBClusterParameterGroup\", \"Properties\": { \"Description\": \"CloudFormation Sample Aurora Cluster Parameter Group\", \"Family\": \"aurora5.6\", \"Parameters\": { \"time_zone\": \"Asia/Calcutta\" } } }, \"RDSCluster\": { \"Type\": \"AWS::RDS::DBCluster\", \"Condition\": \"isResourceCreate\", \"Properties\": { \"Engine\": \"aurora\", \"DBSubnetGroupName\": { \"Ref\": \"DBSubnetGroup\" }, \"DBClusterParameterGroupName\": { \"Ref\": \"RDSDBClusterParameterGroup\" }, \"SnapshotIdentifier\" : { \"Fn::If\" : [ \"UseDbSnapshot\", {\"Ref\" : \"DBSnapshotName\"}, {\"Ref\" : \"AWS::NoValue\"} ] }, \"MasterUsername\": {\"Ref\": \"DbUser\"}, \"MasterUserPassword\": {\"Ref\": \"MasterUserPassword\"}, \"StorageEncrypted\" : {\"Ref\": \"StorageEnc\"}, \"KmsKeyId\" : {\"Ref\": \"KmsKeyId\"}, \"VpcSecurityGroupIds\": [ { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } ], \"Port\": \"3306\", \"BackupRetentionPeriod\": \"1\" }, \"DeletionPolicy\": \"Snapshot\" }, \"RDSDBParameterGroup\": { \"Type\": \"AWS::RDS::DBParameterGroup\", \"Properties\": { \"Description\": \"CloudFormation Sample Aurora Parameter Group\", \"Family\": \"aurora5.6\", \"Parameters\": { \"sql_mode\": \"IGNORE_SPACE\" } } }, \"DbInstance\": { \"Type\": \"AWS::RDS::DBInstance\", \"Condition\": \"isResourceCreate\", \"Properties\": { \"DBSubnetGroupName\": { \"Ref\": \"DBSubnetGroup\" }, \"DBParameterGroupName\": { \"Ref\": \"RDSDBParameterGroup\" ", "keywords": ["cost", "instance", "cluster"]}, {"source": "Text", "text": "}, { \"Key\": \"AdminOwner\", \"Value\": \"AdminOwner\" } ] } } }, \"Outputs\": { \"DBHost\": { \"Description\": \"DB Instance End Point \", \"Value\": { \"Fn::GetAtt\": [ \"DbInstance\", \"Endpoint.Address\" ] }, \"Export\": { \"Name\": { \"Fn::Join\": [ \"-\", [ { \"Ref\": \"BusinessName\" }, { \"Ref\": \"EnvironmentNumber\" }, \"DBHost\" ] ] } } }, \"Environment\": { \"Description\": \"Environment Name \", \"Value\": { \"Ref\": \"EnvironmentName\" } }, \"DBLayerAccessGroupID\": { \"Description\": \"DB Access Security Group Name \", \"Value\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"Export\": { \"Name\": { \"Fn::Join\": [ \"-\", [ { \"Ref\": \"BusinessName\" ", "keywords": ["instance"]}, {"source": "Comment", "text": "updated my CFT for RDS cluster creation", "keywords": ["cluster"]}]}, {"Id": "249645680", "PostHistoryTypeId": "5", "PostId": "68237770", "RevisionGUID": "15a6c4dd-aa6d-4f80-98f8-d2a5bf9d99e1", "CreationDate": "2021-07-04T14:53:25.893", "UserId": "5648234", "Comment": "updated my CFT for RDS cluster creation", "Text": "Trying to create a CFT for RDS which can handle both the scenarios \r\ncreating a new RDS Aurora MySQL cluster and \r\ncreate a RDS cluster with a existing DB Cluster Snapshot \r\n\r\nHere is what I tried,\r\n\r\nI have provide the below conditions section of the template\r\n\r\n    \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n\r\nand referenced in Resource section as below\r\n\r\n    \"RDSCluster1\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"DBSnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDBSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n     ]\r\n      },\r\n    \"MasterUsername\": {\r\n     \"Ref\": \"DbUser\"\r\n    },\r\n    \"MasterUserPassword\": {\r\n     \"Ref\": \"MasterUserPassword\"\r\n    },\r\n    \"StorageEncrypted\" : true,\r\n    \"KmsKeyId\" : {\r\n     \"Ref\": \"KmsKeyId\"\r\n    },\r\n    \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n   },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  }\r\n\r\n\r\nThe condition \"isResourceCreate\" is satisfied but I am getting below error \r\n\r\nTemplate error: unresolved condition dependency UseDBSnapshot in Fn::If\r\n\r\nCould you please help me here.\r\n\r\nHave looked up online link https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html \r\nand created this CFT.\r\n\r\nLet me know if you require any more details.\r\n\r\n\r\n```json\r\n{\r\n \"AWSTemplateFormatVersion\": \"2010-09-09\",\r\n \"Description\": \"This template creates RDS and Elasticsearch resources for Development Environment\",\r\n \"Parameters\": {\r\n  \"Application\": {\r\n   \"Description\": \"Mention the Application Name\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"xyz\"\r\n  },\r\n  \"BusinessName\": {\r\n   \"Description\": \"Mention the Name \",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"xyzbusiness\"\r\n  },\r\n  \"EnvironmentName\": {\r\n   \"Description\": \"Environment Name like Development or Testing or Production\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"Development\",\r\n   \"AllowedValues\": [\r\n    \"Development\",\r\n    \"Staging\",\r\n    \"Pre-Prod\",\r\n    \"Production\"\r\n   ]\r\n  },\r\n  \"EnvironmentNumber\": {\r\n   \"Description\": \"Environment number\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"DEV01\"\r\n  },\r\n  \"VpcId\": {\r\n   \"Description\": \"Enter the VPC identifier. e.g vpc-xxxxxx\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"vpc-xxxxxxx\" \r\n  },\r\n  \"DatabaseSubnetA\": {\r\n   \"Description\": \"Specify the subnet created for DB in Availability Zone a\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"subnet-xxxxxxx\"\r\n  },\r\n  \"DatabaseSubnetB\": {\r\n   \"Description\": \"Specify the subnet created for DB in Availability Zone b\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"subnet-xxxxxxxx\"\r\n  },\r\n  \"DBSnapshotName\": {\r\n   \"Description\": \"Specify the DB snapshot identifier  using which this DB has to be created\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"\"\r\n  },\r\n  \"DbAllocatedStorage\": {\r\n   \"Description\": \"The size of the database in GB\",\r\n   \"Type\": \"Number\",\r\n   \"Default\": \"100\"\r\n  },\r\n  \"DbInstanceClass\": {\r\n   \"Description\": \"Database instance class\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"db.t2.small\"\r\n  },\r\n  \"DbUser\": {\r\n   \"Description\": \"Enter the database user name\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"DBUser\"\r\n  },\r\n  \"MasterUserPassword\": {\r\n   \"Description\": \"Enter DB password. Min length is 8. Alphnumeric only. DO NOT USE SPECIAL SYMBOLS\",\r\n   \"NoEcho\": \"true\",\r\n   \"Type\": \"String\",\r\n   \"MinLength\": \"8\",\r\n   \"MaxLength\": \"41\",\r\n   \"AllowedPattern\": \"[a-zA-Z0-9$]*\",\r\n   \"Default\": \"xxxxxxxxxx\"\r\n  },\r\n  \"StorageEnc\": {\r\n   \"Description\": \"Encrypt RDS with KMS CMK say true or false\",\r\n   \"Type\": \"String\",\r\n   \"AllowedValues\": [\r\n    \"True\",\r\n    \"False\"\r\n   ]\r\n  },\r\n  \"KmsKeyId\": {\r\n   \"Description\" : \"Enter the KMS key arn to encrypt RDS instance\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"arn:aws:kms:region:accID:key/xyzkeyid\"\r\n  },\r\n  \"TopicForEmailAlerts\": {\r\n   \"Description\": \"Enter the topic arn that will be used to send alerts\",\r\n   \"Type\": \"String\",\r\n   \"Default\": \"arn:aws:sns:region:accID:xyzTopic\"\r\n  },\r\n  \"StackResourceAction\": {\r\n   \"Description\": \"Please choose DELETE if you just want to drop the resources to save cost, otherwise choose Create\",\r\n   \"Type\": \"String\",\r\n   \"AllowedValues\": [\r\n    \"Create/Update\",\r\n    \"Delete\"\r\n   ],\r\n   \"Default\": \"Create/Update\"\r\n  }\r\n },\r\n \"Conditions\": {\r\n  \"isResourceCreate\": {\r\n   \"Fn::Equals\": [\r\n    {\r\n     \"Ref\": \"StackResourceAction\"\r\n    },\r\n    \"Create/Update\"\r\n   ]\r\n  },\r\n  \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n },\r\n \"Resources\": {\r\n  \"DBSubnetGroup\": {\r\n   \"Type\": \"AWS::RDS::DBSubnetGroup\",\r\n   \"Properties\": {\r\n    \"DBSubnetGroupDescription\": \"DB Subnet Group to hold the RDS instances\",\r\n    \"SubnetIds\": [\r\n     {\r\n      \"Ref\": \"DatabaseSubnetA\"\r\n     },\r\n     {\r\n      \"Ref\": \"DatabaseSubnetB\"\r\n     }\r\n    ],\r\n    \"Tags\": [\r\n     {\r\n      \"Key\": \"Name\",\r\n      \"Value\": \"DatabaseSubnetGroup\"\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentName\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentName\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentNumber\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentNumber\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"BusinessName\",\r\n      \"Value\": {\r\n       \"Ref\": \"BusinessName\"\r\n      }\r\n     }\r\n    ]\r\n   }\r\n  },\r\n  \"DBAccessSecurityGroup\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroup\",\r\n   \"Properties\": {\r\n    \"GroupDescription\": \"This security group allows web layer to access its DB layer.\",\r\n    \"VpcId\": {\r\n     \"Ref\": \"VpcId\"\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress1\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"3306\",\r\n    \"ToPort\": \"3306\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress2\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"icmp\",\r\n    \"FromPort\": \"-1\",\r\n    \"ToPort\": \"-1\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress3\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"443\",\r\n    \"ToPort\": \"443\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"SGBaseIngress4\": {\r\n   \"Type\": \"AWS::EC2::SecurityGroupIngress\",\r\n   \"Properties\": {\r\n    \"IpProtocol\": \"tcp\",\r\n    \"FromPort\": \"80\",\r\n    \"ToPort\": \"80\",\r\n    \"SourceSecurityGroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    },\r\n    \"GroupId\": {\r\n     \"Fn::GetAtt\": [\r\n      \"DBAccessSecurityGroup\",\r\n      \"GroupId\"\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"RDSDBClusterParameterGroup\": {\r\n   \"Type\": \"AWS::RDS::DBClusterParameterGroup\",\r\n   \"Properties\": {\r\n    \"Description\": \"CloudFormation Sample Aurora Cluster Parameter Group\",\r\n    \"Family\": \"aurora5.6\",\r\n    \"Parameters\": {\r\n     \"time_zone\": \"Asia/Calcutta\"\r\n    }\r\n   }\r\n  },\r\n  \"RDSCluster\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"SnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDbSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n      ]\r\n      },\r\n    \"MasterUsername\": {\"Ref\": \"DbUser\"},\r\n    \"MasterUserPassword\": {\"Ref\": \"MasterUserPassword\"},\r\n    \"StorageEncrypted\" : {\"Ref\": \"StorageEnc\"},\r\n    \"KmsKeyId\" : {\"Ref\": \"KmsKeyId\"},\r\n                \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n    },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  },\r\n  \"RDSDBParameterGroup\": {\r\n   \"Type\": \"AWS::RDS::DBParameterGroup\",\r\n   \"Properties\": {\r\n    \"Description\": \"CloudFormation Sample Aurora Parameter Group\",\r\n    \"Family\": \"aurora5.6\",\r\n    \"Parameters\": {\r\n     \"sql_mode\": \"IGNORE_SPACE\"\r\n    }\r\n   }\r\n  },\r\n  \"DbInstance\": {\r\n   \"Type\": \"AWS::RDS::DBInstance\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBParameterGroupName\": {\r\n     \"Ref\": \"RDSDBParameterGroup\"\r\n    },\r\n    \"Engine\": \"aurora\",\r\n    \"DBClusterIdentifier\": {\r\n     \"Ref\": \"RDSCluster\"\r\n    },\r\n    \"PubliclyAccessible\": true,\r\n    \"DBInstanceClass\": {\r\n     \"Ref\": \"DbInstanceClass\"\r\n    },\r\n    \"CopyTagsToSnapshot\": true,\r\n    \"Tags\": [\r\n     {\r\n      \"Key\": \"EnvironmentName\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentName\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"EnvironmentNumber\",\r\n      \"Value\": {\r\n       \"Ref\": \"EnvironmentNumber\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"ApplicationName\",\r\n      \"Value\": {\r\n       \"Ref\": \"Application\"\r\n      }\r\n     },\r\n     {\r\n      \"Key\": \"BusinessOwner\",\r\n      \"Value\": \"Xyzowner\"\r\n     },\r\n     {\r\n      \"Key\": \"ApplicationOwner\",\r\n      \"Value\": \"AppOwner\"\r\n     },\r\n     {\r\n      \"Key\": \"AdminOwner\",\r\n      \"Value\": \"AdminOwner\"\r\n     }\r\n    ]\r\n   }\r\n  }\r\n },\r\n \"Outputs\": {\r\n  \"DBHost\": {\r\n   \"Description\": \"DB Instance End Point \",\r\n   \"Value\": {\r\n    \"Fn::GetAtt\": [\r\n     \"DbInstance\",\r\n     \"Endpoint.Address\"\r\n    ]\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBHost\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"Environment\": {\r\n   \"Description\": \"Environment Name \",\r\n   \"Value\": {\r\n    \"Ref\": \"EnvironmentName\"\r\n   }\r\n  },\r\n  \"DBLayerAccessGroupID\": {\r\n   \"Description\": \"DB Access Security Group Name \",\r\n   \"Value\": {\r\n    \"Fn::GetAtt\": [\r\n     \"DBAccessSecurityGroup\",\r\n     \"GroupId\"\r\n    ]\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBLayerAccessGroupID\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  },\r\n  \"DBHostUserId\": {\r\n   \"Description\": \"User ID of the database for the user. \",\r\n   \"Value\": {\r\n    \"Ref\": \"DbUser\"\r\n   },\r\n   \"Export\": {\r\n    \"Name\": {\r\n     \"Fn::Join\": [\r\n      \"-\",\r\n      [\r\n       {\r\n        \"Ref\": \"BusinessName\"\r\n       },\r\n       {\r\n        \"Ref\": \"EnvironmentNumber\"\r\n       },\r\n       \"DBUserID\"\r\n      ]\r\n     ]\r\n    }\r\n   }\r\n  }\r\n }\r\n}\r\n```\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Trying to create a CFT for RDS which can handle both the scenarios creating a new RDS Aurora MySQL cluster and create a RDS cluster with a existing DB Cluster Snapshot ", "keywords": ["cluster"]}, {"source": "Text", "text": "```json { \"AWSTemplateFormatVersion\": \"2010-09-09\", \"Description\": \"This template creates RDS and Elasticsearch resources for Development Environment\", \"Parameters\": { \"Application\": { \"Description\": \"Mention the Application Name\", \"Type\": \"String\", \"Default\": \"xyz\" }, \"BusinessName\": { \"Description\": \"Mention the Name \", \"Type\": \"String\", \"Default\": \"xyzbusiness\" }, \"EnvironmentName\": { \"Description\": \"Environment Name like Development or Testing or Production\", \"Type\": \"String\", \"Default\": \"Development\", \"AllowedValues\": [ \"Development\", \"Staging\", \"Pre-Prod\", \"Production\" ] }, \"EnvironmentNumber\": { \"Description\": \"Environment number\", \"Type\": \"String\", \"Default\": \"DEV01\" }, \"VpcId\": { \"Description\": \"Enter the VPC identifier. e.g vpc-xxxxxx\", \"Type\": \"String\", \"Default\": \"vpc-xxxxxxx\" }, \"DatabaseSubnetA\": { \"Description\": \"Specify the subnet created for DB in Availability Zone a\", \"Type\": \"String\", \"Default\": \"subnet-xxxxxxx\" }, \"DatabaseSubnetB\": { \"Description\": \"Specify the subnet created for DB in Availability Zone b\", \"Type\": \"String\", \"Default\": \"subnet-xxxxxxxx\" }, \"DBSnapshotName\": { \"Description\": \"Specify the DB snapshot identifier using which this DB has to be created\", \"Type\": \"String\", \"Default\": \"\" }, \"DbAllocatedStorage\": { \"Description\": \"The size of the database in GB\", \"Type\": \"Number\", \"Default\": \"100\" }, \"DbInstanceClass\": { \"Description\": \"Database instance class\", \"Type\": \"String\", \"Default\": \"db.t2.small\" }, \"DbUser\": { \"Description\": \"Enter the database user name\", \"Type\": \"String\", \"Default\": \"DBUser\" }, \"MasterUserPassword\": { \"Description\": \"Enter DB password. ", "keywords": ["instance", "test"]}, {"source": "Text", "text": "Min length is 8. Alphnumeric only. DO NOT USE SPECIAL SYMBOLS\", \"NoEcho\": \"true\", \"Type\": \"String\", \"MinLength\": \"8\", \"MaxLength\": \"41\", \"AllowedPattern\": \"[a-zA-Z0-9$]*\", \"Default\": \"xxxxxxxxxx\" }, \"StorageEnc\": { \"Description\": \"Encrypt RDS with KMS CMK say true or false\", \"Type\": \"String\", \"AllowedValues\": [ \"True\", \"False\" ] }, \"KmsKeyId\": { \"Description\" : \"Enter the KMS key arn to encrypt RDS instance\", \"Type\": \"String\", \"Default\": \"arn:aws:kms:region:accID:key/xyzkeyid\" }, \"TopicForEmailAlerts\": { \"Description\": \"Enter the topic arn that will be used to send alerts\", \"Type\": \"String\", \"Default\": \"arn:aws:sns:region:accID:xyzTopic\" }, \"StackResourceAction\": { \"Description\": \"Please choose DELETE if you just want to drop the resources to save cost, otherwise choose Create\", \"Type\": \"String\", \"AllowedValues\": [ \"Create/Update\", \"Delete\" ], \"Default\": \"Create/Update\" } }, \"Conditions\": { \"isResourceCreate\": { \"Fn::Equals\": [ { \"Ref\": \"StackResourceAction\" }, \"Create/Update\" ] }, \"UseDbSnapshot\" : { \"Fn::Not\" : [ { \"Fn::Equals\":[ {\"Ref\": \"DBSnapshotName\"}, \"\" ] } ] } }, \"Resources\": { \"DBSubnetGroup\": { \"Type\": \"AWS::RDS::DBSubnetGroup\", \"Properties\": { \"DBSubnetGroupDescription\": \"DB Subnet Group to hold the RDS instances\", \"SubnetIds\": [ { \"Ref\": \"DatabaseSubnetA\" }, { \"Ref\": \"DatabaseSubnetB\" } ], \"Tags\": [ { \"Key\": \"Name\", \"Value\": \"DatabaseSubnetGroup\" }, { \"Key\": \"EnvironmentName\", \"Value\": { \"Ref\": \"EnvironmentName\" } }, { \"Key\": \"EnvironmentNumber\", \"Value\": { \"Ref\": \"EnvironmentNumber\" } }, { \"Key\": \"BusinessName\", \"Value\": { \"Ref\": \"BusinessName\" } } ] } }, \"DBAccessSecurityGroup\": { \"Type\": \"AWS::EC2::SecurityGroup\", \"Properties\": { \"GroupDescription\": \"This security group allows web layer to access its DB layer.\", \"VpcId\": { \"Ref\": \"VpcId\" } } }, \"SGBaseIngress1\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"3306\", \"ToPort\": \"3306\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress2\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"icmp\", \"FromPort\": \"-1\", \"ToPort\": \"-1\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress3\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"443\", \"ToPort\": \"443\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"SGBaseIngress4\": { \"Type\": \"AWS::EC2::SecurityGroupIngress\", \"Properties\": { \"IpProtocol\": \"tcp\", \"FromPort\": \"80\", \"ToPort\": \"80\", \"SourceSecurityGroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] }, \"GroupId\": { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } } }, \"RDSDBClusterParameterGroup\": { \"Type\": \"AWS::RDS::DBClusterParameterGroup\", \"Properties\": { \"Description\": \"CloudFormation Sample Aurora Cluster Parameter Group\", \"Family\": \"aurora5.6\", \"Parameters\": { \"time_zone\": \"Asia/Calcutta\" } } }, \"RDSCluster\": { \"Type\": \"AWS::RDS::DBCluster\", \"Condition\": \"isResourceCreate\", \"Properties\": { \"Engine\": \"aurora\", \"DBSubnetGroupName\": { \"Ref\": \"DBSubnetGroup\" }, \"DBClusterParameterGroupName\": { \"Ref\": \"RDSDBClusterParameterGroup\" }, \"SnapshotIdentifier\" : { \"Fn::If\" : [ \"UseDbSnapshot\", {\"Ref\" : \"DBSnapshotName\"}, {\"Ref\" : \"AWS::NoValue\"} ] }, \"MasterUsername\": {\"Ref\": \"DbUser\"}, \"MasterUserPassword\": {\"Ref\": \"MasterUserPassword\"}, \"StorageEncrypted\" : {\"Ref\": \"StorageEnc\"}, \"KmsKeyId\" : {\"Ref\": \"KmsKeyId\"}, \"VpcSecurityGroupIds\": [ { \"Fn::GetAtt\": [ \"DBAccessSecurityGroup\", \"GroupId\" ] } ], \"Port\": \"3306\", \"BackupRetentionPeriod\": \"1\" }, \"DeletionPolicy\": \"Snapshot\" }, \"RDSDBParameterGroup\": { \"Type\": \"AWS::RDS::DBParameterGroup\", \"Properties\": { \"Description\": \"CloudFormation Sample Aurora Parameter Group\", \"Family\": \"aurora5.6\", \"Parameters\": { \"sql_mode\": \"IGNORE_SPACE\" } } }, \"DbInstance\": { \"Type\": \"AWS::RDS::DBInstance\", \"Condition\": \"isResourceCreate\", \"Properties\": { \"DBSubnetGroupName\": { \"Ref\": \"DBSubnetGroup\" }, \"DBParameterGroupName\": { \"Ref\": \"RDSDBParameterGroup\" ", "keywords": ["cost", "instance", "cluster"]}, {"source": "Text", "text": "}, { \"Key\": \"AdminOwner\", \"Value\": \"AdminOwner\" } ] } } }, \"Outputs\": { \"DBHost\": { \"Description\": \"DB Instance End Point \", \"Value\": { \"Fn::GetAtt\": [ \"DbInstance\", \"Endpoint.Address\" ] }, \"Export\": { \"Name\": { \"Fn::Join\": [ \"-\", [ { \"Ref\": \"BusinessName\" ", "keywords": ["instance"]}, {"source": "Comment", "text": "updated my CFT for RDS cluster creation", "keywords": ["cluster"]}]}, {"Id": "249690453", "PostHistoryTypeId": "5", "PostId": "68237770", "RevisionGUID": "4f15d0ab-6286-4e5c-8c4a-ba3c9da1ec24", "CreationDate": "2021-07-05T12:44:35.053", "UserId": "5648234", "Comment": "deleted 9584 characters in body", "Text": "Trying to create a CFT for RDS which can handle both the scenarios \r\ncreating a new RDS Aurora MySQL cluster and \r\ncreate a RDS cluster with a existing DB Cluster Snapshot \r\n\r\nHere is what I tried,\r\n\r\nI have provide the below conditions section of the template\r\n\r\n    \"UseDbSnapshot\" : {\r\n      \"Fn::Not\" : [\r\n       {\r\n        \"Fn::Equals\":[\r\n        {\"Ref\": \"DBSnapshotName\"},\r\n           \"\"\r\n          ]\r\n         }\r\n        ]\r\n       }\r\n\r\nand referenced in Resource section as below\r\n\r\n    \"RDSCluster1\": {\r\n   \"Type\": \"AWS::RDS::DBCluster\",\r\n   \"Condition\": \"isResourceCreate\",\r\n   \"Properties\": {\r\n    \"Engine\": \"aurora\",\r\n    \"DBSubnetGroupName\": {\r\n     \"Ref\": \"DBSubnetGroup\"\r\n    },\r\n    \"DBClusterParameterGroupName\": {\r\n     \"Ref\": \"RDSDBClusterParameterGroup\"\r\n    },\r\n    \"DBSnapshotIdentifier\" : {\r\n     \"Fn::If\" : [\r\n       \"UseDBSnapshot\",\r\n       {\"Ref\" : \"DBSnapshotName\"},\r\n       {\"Ref\" : \"AWS::NoValue\"}\r\n     ]\r\n      },\r\n    \"MasterUsername\": {\r\n     \"Ref\": \"DbUser\"\r\n    },\r\n    \"MasterUserPassword\": {\r\n     \"Ref\": \"MasterUserPassword\"\r\n    },\r\n    \"StorageEncrypted\" : true,\r\n    \"KmsKeyId\" : {\r\n     \"Ref\": \"KmsKeyId\"\r\n    },\r\n    \"VpcSecurityGroupIds\": [\r\n     {\r\n      \"Fn::GetAtt\": [\r\n       \"DBAccessSecurityGroup\",\r\n       \"GroupId\"\r\n      ]\r\n     }\r\n    ],\r\n    \"Port\": \"3306\",\r\n    \"BackupRetentionPeriod\": \"1\"\r\n   },\r\n   \"DeletionPolicy\": \"Snapshot\"\r\n  }\r\n\r\n\r\nThe condition \"isResourceCreate\" is satisfied but I am getting below error \r\n\r\nTemplate error: unresolved condition dependency UseDBSnapshot in Fn::If\r\n\r\nCould you please help me here.\r\n\r\nHave looked up online link https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html \r\nand created this CFT.\r\n\r\nLet me know if you require any more details.\r\n\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Trying to create a CFT for RDS which can handle both the scenarios creating a new RDS Aurora MySQL cluster and create a RDS cluster with a existing DB Cluster Snapshot ", "keywords": ["cluster"]}]}], "answers": [{"Id": "68248958", "PostTypeId": "2", "ParentId": "68237770", "CreationDate": "2021-07-04T21:36:30.693", "Score": "1", "Body": "<p>If you are restoring DB from snapshot, you <strong>can't provide</strong> <code>MasterUsername</code> and <code>MasterUserPassword</code>. These values will be <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html\" rel=\"nofollow noreferrer\">inherited</a> from the snapshot, so you have to make them <strong>optional</strong>.</p>\n<blockquote>\n<p>If you specify the SourceDBInstanceIdentifier or DBSnapshotIdentifier property, don't specify this property. The value is <strong>inherited from the source DB instance or snapshot</strong>.</p>\n</blockquote>\n", "OwnerUserId": "248823", "LastActivityDate": "2021-07-04T21:36:30.693", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "249658487", "PostHistoryTypeId": "2", "PostId": "68248958", "RevisionGUID": "267d3b94-4608-424f-971b-1661b6013a4d", "CreationDate": "2021-07-04T21:36:30.693", "UserId": "248823", "Text": "If you are restoring DB from snapshot, you **can't provide** `MasterUsername` and `MasterUserPassword`. These values will be [inherited](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html) from the snapshot, so you have to make them **optional**.\r\n\r\n> If you specify the SourceDBInstanceIdentifier or DBSnapshotIdentifier property, don't specify this property. The value is **inherited from the source DB instance or snapshot**. ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "These values will be [inherited](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html) from the snapshot, so you have to make them **optional**. ", "keywords": ["instance"]}, {"source": "Text", "text": "The value is **inherited from the source DB instance or snapshot**.", "keywords": ["instance"]}]}], "filtered-sentences": [{"source": "Body", "text": "The value is inherited from the source DB instance or snapshot.", "keywords": ["instance"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "Trying to create a CFT for RDS which can handle both the scenarios creating a new RDS Aurora MySQL cluster and create a RDS cluster with a existing DB Cluster Snapshot Here is what I tried, I have provide the below conditions section of the template and referenced in Resource section as below ", "keywords": ["cluster"]}]}