{"Id": "73756440", "PostTypeId": "1", "AcceptedAnswerId": "73756967", "CreationDate": "2022-09-17T16:06:52.787", "Score": "2", "ViewCount": "849", "Body": "<p>I need to create a <code>CloudFormation</code> SAM template that creates multiple resources. I also need to integrate <code>GitHub Actions</code> so code gets auto deployed on push. The problem is this requires that I give GitHub a lot of IAM permissions to do the necessary work. Note that I'm using an Open ID identity provider for GitHub as opposed to api keys.</p>\n<p>How do I find out which IAM permissions are needed at minimum so I don't give GitHub more than what is necessary? Is there an AWS tool that can parse the deployment template and tell me which permissions are needed for both <strong>deployments</strong> and <strong>rollbacks</strong>?</p>\n", "OwnerUserId": "246392", "LastActivityDate": "2022-10-07T12:12:25.260", "Title": "AWS: How to find out minimum required IAM permissions for GitHub Actions integration", "Tags": "|amazon-web-services|aws-cloudformation|github-actions|aws-sam|", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "278423922", "PostHistoryTypeId": "2", "PostId": "73756440", "RevisionGUID": "6a146f63-d959-47a8-a47d-164e5040b95b", "CreationDate": "2022-09-17T16:06:52.787", "UserId": "246392", "Text": "I need to create a `CloudFormation` SAM template that creates multiple resources. I also need to integrate `GitHub Actions` so code gets auto deployed on push. The problem is this requires that I give GitHub a lot of IAM permissions to do the necessary work. Note that I'm using an Open ID identity provider for GitHub as opposed to api keys.\r\n\r\nHow do I find out which IAM permissions are needed at minimum so I don't give GitHub more than what is necessary? Is there an AWS tool that can parse the deployment template and tell me which permissions are needed for both **deployments** and **rollbacks**?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Note that I'm using an Open ID identity provider for GitHub as opposed to api keys. ", "keywords": ["provider"]}]}, {"Id": "278423924", "PostHistoryTypeId": "1", "PostId": "73756440", "RevisionGUID": "6a146f63-d959-47a8-a47d-164e5040b95b", "CreationDate": "2022-09-17T16:06:52.787", "UserId": "246392", "Text": "AWS: How to find out minimum required IAM permissions for GitHub Actions integration", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "278423925", "PostHistoryTypeId": "3", "PostId": "73756440", "RevisionGUID": "6a146f63-d959-47a8-a47d-164e5040b95b", "CreationDate": "2022-09-17T16:06:52.787", "UserId": "246392", "Text": "|amazon-web-services|aws-cloudformation|github-actions|aws-sam|", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "73756967", "PostTypeId": "2", "ParentId": "73756440", "CreationDate": "2022-09-17T17:14:21.897", "Score": "3", "Body": "<p>No, there's no such tool. You can however look at the Cloudtrail logs to see which actions are being invoked by CloudFormation, and based on that you could put together the list of required policies.</p>\n<p>Alternatively, you could replicate what the CloudFormation template is doing by using the AWS CLI. That way, you could use  <a href=\"https://github.com/iann0036/iamlive\" rel=\"nofollow noreferrer\">iamlive</a> to  generate the IAM policies required for those CLI commands.</p>\n", "OwnerUserId": "3390419", "LastActivityDate": "2022-09-17T17:14:21.897", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "130241215", "PostId": "73756967", "Score": "1", "Text": "`iamlive` looks pretty cool. I don't mind using this, but how do I convert the CF template (with declarative syntax) to CLI commands?", "CreationDate": "2022-09-17T17:19:23.327", "UserId": "246392", "filtered-sentences": []}, {"Id": "130241359", "PostId": "73756967", "Score": "1", "Text": "@user246392 you'll have to go through each resource in the template one by one and you'll have to try and create each resource with the required CLI command (use `--dry-run` to mock the creation)", "CreationDate": "2022-09-17T17:30:55.447", "UserId": "3390419", "filtered-sentences": []}, {"Id": "132960427", "PostId": "73756967", "Score": "0", "Text": "Cloudtrail isn't free. So basically I need to pay $2.5/month JUST to know which permissions the user needs? lol, they do find a way to charge you for everything on AWS", "CreationDate": "2023-02-05T12:53:35.007", "UserId": "2076973", "filtered-sentences": [{"source": "Text", "text": "So basically I need to pay $2.5/month JUST to know which permissions the user needs? lol, they do find a way to charge you for everything on AWS", "keywords": ["pay"]}]}], "history": [{"Id": "278426672", "PostHistoryTypeId": "2", "PostId": "73756967", "RevisionGUID": "976ce41c-521f-497c-b208-4845861a7af1", "CreationDate": "2022-09-17T17:14:21.897", "UserId": "3390419", "Text": "No, there's no such tool. You can however look at the Cloudtrail logs to see which actions are being invoked by CloudFormation, and based on that you could put together the list of required policies. \r\n\r\nAlternatively, you could replicate what the CloudFormation template is doing by using the AWS CLI. That way, you could use  [iamlive](https://github.com/iann0036/iamlive) to  generate the IAM policies required for those CLI commands.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "Note that I'm using an Open ID identity provider for GitHub as opposed to api keys. ", "keywords": ["provider"]}]}